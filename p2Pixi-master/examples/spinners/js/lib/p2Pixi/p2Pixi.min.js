/** 
 * p2Pixi v1.0.6 - 04-09-2016 
 * Copyright (c) Tom W Hall <tomshalls@gmail.com> 
 * A simple 2D vector game model framework using p2.js for physics and Pixi.js for rendering. 
 * License: MIT 
 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.P2Pixi=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./PixiAdapter");b.exports=function(){function a(a){a=a||{},a.pixiAdapterOptions=a.pixiAdapterOptions||{},a.pixiAdapter=a.pixiAdapter||new d(a.pixiAdapterOptions),a.worldOptions=a.worldOptions||{},a.worldOptions.gravity=a.worldOptions.gravity||[0,-9.8],a.trackedBodyOffset=a.trackedBodyOffset||[0,0],this.options=a,this.pixiAdapter=a.pixiAdapter,this.world=new p2.World(a.worldOptions),this.gameObjects=[],this.trackedBody=null,this.paused=!1,this.windowFocused=!0;var b=this;window.addEventListener("blur",function(a){b.windowBlur(a)}),window.addEventListener("focus",function(a){b.windowFocus(a)}),this.lastTimeSeconds=null,this.assetsLoaded=!1,a.assetUrls?this.loadAssets(a.assetUrls):this.runIfReady()}return a.prototype.loadAssets=function(a){for(var b=PIXI.loader,c=0;c<a.length;c++)b.add(a[c],a[c]);var d=this;b.once("complete",function(){d.assetsLoaded=!0,d.runIfReady()}),b.load()},a.prototype.isReadyToRun=function(){return this.assetsLoaded},a.prototype.runIfReady=function(){this.isReadyToRun()&&(this.beforeRun(),this.run())},a.prototype.beforeRun=function(){},a.prototype.run=function(){function a(f){d.windowFocused&&!d.paused&&(b=f/1e3,c=b-(d.lastTimeSeconds||b),d.lastTimeSeconds=b,d.world.step(e,c,10)),d.beforeRender(),d.render(),d.afterRender(),requestAnimationFrame(a)}this.lastTimeSeconds=null;var b,c,d=this,e=1/60;requestAnimationFrame(a)},a.prototype.beforeRender=function(){var a=this.trackedBody;if(null!==a){var b=this.pixiAdapter,c=b.renderer,d=b.pixelsPerLengthUnit,e=b.container.position,f=a.position,g=this.options.trackedBodyOffset;e.x=(g[0]+1)*c.width*.5-f[0]*d,e.y=(g[1]+1)*c.height*.5+f[1]*d}},a.prototype.render=function(){for(var a=this.gameObjects,b=this.pixiAdapter,c=0;c<a.length;c++)a[c].updateTransforms();b.renderer.render(b.stage)},a.prototype.afterRender=function(){},a.prototype.addGameObject=function(a){this.gameObjects.push(a)},a.prototype.removeGameObject=function(a){a.remove()},a.prototype.clear=function(){for(;this.gameObjects.length>0;)this.removeGameObject(this.gameObjects[0])},a.prototype.pauseToggle=function(){this.paused=!this.paused,this.paused||(this.lastTimeSeconds=performance.now()/1e3)},a.prototype.windowBlur=function(a){this.windowFocused=!1},a.prototype.windowFocus=function(a){this.windowFocused=!0,this.paused||(this.lastTimeSeconds=performance.now()/1e3)},a}()},{"./PixiAdapter":3}],2:[function(a,b,c){b.exports=function(){function a(a){this.game=a,this.bodies=[],this.constraints=[],this.containers=[],this.children=[]}return a.prototype.addBody=function(a){this.bodies.push(a),this.game.world.addBody(a);var b=new PIXI.Container;return this.containers.push(b),this.game.pixiAdapter.container.addChild(b),this},a.prototype.removeBody=function(a){var b=this.bodies.indexOf(a);return this.bodies.splice(b,1),this.game.world.removeBody(a),this.containers.splice(b,1),this.game.pixiAdapter.container.removeChildAt(b),this},a.prototype.addShape=function(a,b,c){var d=c.offset||[0,0],e=c.angle||0;b.collisionGroup=c.collisionOptions&&c.collisionOptions.collisionGroup||1,b.collisionMask=c.collisionOptions&&c.collisionOptions.collisionMask||1,a.addShape(b,d,e);var f=this.containers[this.bodies.indexOf(a)];return this.game.pixiAdapter.addShape(f,b,c),this},a.prototype.addConstraint=function(a){return this.constraints.push(a),this.game.world.addConstraint(a),this},a.prototype.removeConstraint=function(a){return this.game.world.removeConstraint(a),this},a.prototype.addChild=function(a){a.parent=this,this.children.push(a)},a.prototype.updateTransforms=function(){for(var a=this.game.pixiAdapter.pixelsPerLengthUnit,b=this.bodies,c=this.containers,d=0;d<b.length;d++){var e=b[d],f=c[d];f.position.x=e.position[0]*a,f.position.y=-e.position[1]*a,f.rotation=-e.angle}for(var g=this.children,d=0;d<g.length;d++)g[d].updateTransforms()},a.prototype.remove=function(){for(var a=this.game,b=a.world,c=a.pixiAdapter.container;this.children.length>0;)this.children[0].remove();for(var d=0;d<this.constraints.length;d++)b.removeConstraint(this.constraints[d]);for(var d=0;d<this.bodies.length;d++)b.removeBody(this.bodies[d]),c.removeChild(this.containers[d]);if(this.parent){var e=this.parent.children.indexOf(this);this.parent.children.splice(e,1),this.parent=void 0}else{var e=a.gameObjects.indexOf(this);a.gameObjects.splice(e,1)}},a}()},{}],3:[function(a,b,c){b.exports=function(){function a(a){var b={width:1280,height:720,pixelsPerLengthUnit:128,useDeviceAspect:!1};a=a||{};for(var c in a)b[c]=a[c];b.useDeviceAspect&&(b.height=window.innerHeight/window.innerWidth*b.width),this.options=b,this.pixelsPerLengthUnit=this.options.pixelsPerLengthUnit,this.stage=new PIXI.Container,this.container=new PIXI.Container,this.stage.addChild(this.container),this.setupRenderer(),this.setupView()}var b=p2.vec2,c=p2.Circle,d=p2.Capsule,e=p2.Convex,f=p2.Plane,g=p2.Box,h=p2.Particle,i=p2.Line,j=p2.Heightfield;return a.prototype.setupRenderer=function(){var a=this.options;this.renderer=PIXI.autoDetectRenderer(a.width,a.height,a.rendererOptions)},a.prototype.setupView=function(){function a(){b.resize(window.innerWidth,window.innerHeight)}var b=this,c=this.renderer,d=this.renderer.view,e=this.container;d.style.position="absolute",this.options.view||document.body.appendChild(this.renderer.view),this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,e.position.x=c.width/2,e.position.y=c.height/2,this.viewCssWidth=0,this.viewCssHeight=0,this.resize(this.windowWidth,this.windowHeight),window.addEventListener("resize",a),window.addEventListener("orientationchange",a)},a.prototype.drawCircle=function(a,b,c,d,e){e=e||{};var f=e.lineWidthUnits?e.lineWidthUnits*this.pixelsPerLengthUnit:e.lineWidth||0,g=e.lineColor||0,h=e.fillColor;a.lineStyle(f,g,1),h&&a.beginFill(h,1),a.drawCircle(b,c,d),h&&a.endFill()},a.prototype.drawPlane=function(a,b,c,d){d=d||{};var e=1e6,f=d.lineWidthUnits?d.lineWidthUnits*this.pixelsPerLengthUnit:d.lineWidth||0,g=d.lineColor||0,h=d.fillColor;a.lineStyle(f,g,1),h&&a.beginFill(h,1),a.moveTo(-e,0),a.lineTo(e,0),a.lineTo(e,-e),a.lineTo(-e,-e),h&&a.endFill(),a.lineStyle(f,g),a.moveTo(-e,0),a.lineTo(e,0)},a.prototype.drawLine=function(a,b,c){c=c||{};var d=c.lineWidthUnits?c.lineWidthUnits*this.pixelsPerLengthUnit:c.lineWidth||1,e=c.lineColor||0;a.lineStyle(d,e,1),a.moveTo(-b/2,0),a.lineTo(b/2,0)},a.prototype.drawCapsule=function(a,b,c,d,e,f,g){g=g||{};var h=Math.cos(d),i=Math.sin(d),j=g.lineWidthUnits?g.lineWidthUnits*this.pixelsPerLengthUnit:g.lineWidth||0,k=g.lineColor||0,l=g.fillColor;a.lineStyle(j,k,1),l&&a.beginFill(l,1),a.drawCircle(-e/2*h+b,-e/2*i+c,f),a.drawCircle(e/2*h+b,e/2*i+c,f),l&&a.endFill(),a.lineStyle(j,k,0),l&&a.beginFill(l,1),a.moveTo(-e/2*h+f*i+b,-e/2*i+f*h+c),a.lineTo(e/2*h+f*i+b,e/2*i+f*h+c),a.lineTo(e/2*h-f*i+b,e/2*i-f*h+c),a.lineTo(-e/2*h-f*i+b,-e/2*i-f*h+c),l&&a.endFill(),a.lineStyle(j,k,1),a.moveTo(-e/2*h+f*i+b,-e/2*i+f*h+c),a.lineTo(e/2*h+f*i+b,e/2*i+f*h+c),a.moveTo(-e/2*h-f*i+b,-e/2*i-f*h+c),a.lineTo(e/2*h-f*i+b,e/2*i-f*h+c)},a.prototype.drawBox=function(a,b,c,d,e,f){f=f||{};var g=f.lineWidthUnits?f.lineWidthUnits*this.pixelsPerLengthUnit:f.lineWidth||0,h=f.lineColor||0,i=f.fillColor;a.lineStyle(g,h,1),i&&a.beginFill(i,1),a.drawRect(b-d/2,c-e/2,d,e),i&&a.endFill()},a.prototype.drawConvex=function(a,b,c){c=c||{};var d=c.lineWidthUnits?c.lineWidthUnits*this.pixelsPerLengthUnit:c.lineWidth||0,e=c.lineColor||0,f=c.fillColor;a.lineStyle(d,e,1),f&&a.beginFill(f,1);for(var g=0;g!==b.length;g++){var h=b[g],i=h[0],j=h[1];0===g?a.moveTo(i,j):a.lineTo(i,j)}f&&a.endFill(),b.length>2&&0!==d&&(a.moveTo(b[b.length-1][0],b[b.length-1][1]),a.lineTo(b[0][0],b[0][1]))},a.prototype.drawPath=function(a,b,c){c=c||{};var d=c.lineWidthUnits?c.lineWidthUnits*this.pixelsPerLengthUnit:c.lineWidth||0,e=c.lineColor||0,f=c.fillColor;a.lineStyle(d,e,1),f&&a.beginFill(f,1);for(var g=null,h=null,i=0;i<b.length;i++){var j=b[i],k=j[0],l=j[1];if(k!==g||l!==h){if(0===i)a.moveTo(k,l);else{var m=g,n=h,o=k,p=l,q=b[(i+1)%b.length][0],r=b[(i+1)%b.length][1],s=(o-m)*(r-n)-(q-m)*(p-n);0!==s&&a.lineTo(k,l)}g=k,h=l}}f&&a.endFill(),b.length>2&&c.fillColor&&(a.moveTo(b[b.length-1][0],b[b.length-1][1]),a.lineTo(b[0][0],b[0][1]))},a.prototype.renderShapeToGraphics=function(a,k,l,m,n){var o=[0,0],p=this.pixelsPerLengthUnit;if(l=l||o,m=m||0,k instanceof c)this.drawCircle(a,l[0]*p,-l[1]*p,k.radius*p,n);else if(k instanceof h){var q=Math.max(1,Math.round(p/100));this.drawCircle(a,l[0]*p,-l[1]*p,q,n)}else if(k instanceof f)this.drawPlane(a,-10*p,10*p,n);else if(k instanceof i)this.drawLine(a,k.length*p,n);else if(k instanceof g)this.drawBox(a,l[0]*p,-l[1]*p,k.width*p,k.height*p,n);else if(k instanceof d)this.drawCapsule(a,l[0]*p,-l[1]*p,m,k.length*p,k.radius*p,n);else if(k instanceof e){for(var r=[],s=b.create(),t=0;t<k.vertices.length;t++){var u=k.vertices[t];b.rotate(s,u,m),r.push([(s[0]+l[0])*p,-(s[1]+l[1])*p])}this.drawConvex(a,r,n)}else if(k instanceof j){for(var v=k.heights,w=[[0,100*p]],t=0;t<v.length;t++){var x=v[t];w.push([t*k.elementWidth*p,-x*p])}w.push([v.length*k.elementWidth*p,100*p]),this.drawPath(a,w,n)}},a.prototype.addShape=function(a,b,c){c=c||{};var d=c.offset||[0,0],e=c.angle||0,f=c.textureOptions,h=c.styleOptions,i=c.alpha||1,k=[0,0],l=this.pixelsPerLengthUnit;if(f){var m=f.texture,n=new p2.AABB;b.computeAABB(n,k,0);var o=n.lowerBound[0],p=n.lowerBound[1],q=n.upperBound[0],r=n.upperBound[1];b instanceof j&&(p=-(this.options.height/l));var s,t=q-o,u=r-p;if(s=f.tile===!1?new PIXI.Sprite(m):new PIXI.extras.TilingSprite(m,t*l,u*l),s.alpha=i,!(b instanceof g)){var v=new PIXI.Graphics;v.renderable=!1,v.position.x=d[0]*l,v.position.y=-(d[1]*l),v.rotation=-e,this.renderShapeToGraphics(v,b,k,0,{lineWidth:0,fillColor:16777215}),a.addChild(v),s.mask=v}b instanceof j?s.anchor=new PIXI.Point(0,.5):s.anchor=new PIXI.Point(.5,.5),s.position.x=d[0]*l,s.position.y=-(d[1]*l),s.rotation=-e,a.addChild(s)}if(h){var w=new PIXI.Graphics;w.alpha=i,w.position.x=d[0]*l,w.position.y=-(d[1]*l),w.rotation=-e,this.renderShapeToGraphics(w,b,k,0,h),a.addChild(w)}},a.prototype.resize=function(a,b){var c=this.renderer,d=c.view,e=a/b,f=c.width/c.height;this.windowWidth=a,this.windowHeight=b,e>f?(this.viewCssWidth=b*f,this.viewCssHeight=b,d.style.width=this.viewCssWidth+"px",d.style.height=this.viewCssHeight+"px",d.style.left=Math.round((a-this.viewCssWidth)/2)+"px",d.style.top=null):(this.viewCssWidth=a,this.viewCssHeight=Math.round(a/f),d.style.width=this.viewCssWidth+"px",d.style.height=this.viewCssHeight+"px",d.style.left=null,d.style.top=Math.round((b-this.viewCssHeight)/2)+"px")},a}()},{}],4:[function(a,b,c){b.exports={Game:a("./Game"),GameObject:a("./GameObject"),PixiAdapter:a("./PixiAdapter")}},{"./Game":1,"./GameObject":2,"./PixiAdapter":3}]},{},[4])(4)});