/*!
 * puxi.js - v0.0.0
 * Compiled Sun, 22 Mar 2020 22:05:27 UTC
 *
 * puxi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PUXI=this.PUXI||{};var puxi_js=function(t,e,i){"use strict";const s=[],h={add:(t,e)=>(t._dragDropEventId=e.data.identifier,-1===s.indexOf(t)&&(s.push(t),!0)),getItem(t){let e,i=null;for(let h=0;h<s.length;h++)if(s[h]===t){i=s[h],e=h;break}return null!==i&&(s.splice(e,1),i)},getEventItem(t,e){let i,h=null;const n=t.data.identifier;for(let t=0;t<s.length;t++)if(s[t]._dragDropEventId===n){if(e!==s[t].dragGroup)return!1;h=s[t],i=t;break}return null!==h&&(s.splice(i,1),h)}};class n{constructor(){this.reset(),this.dirtyId=0}reset(){this.left=-1,this.top=-1,this.right=-1,this.bottom=-1}}var r,o;(r=t.MeasureMode||(t.MeasureMode={}))[r.UNBOUNDED=0]="UNBOUNDED",r[r.EXACTLY=1]="EXACTLY",r[r.AT_MOST=2]="AT_MOST";class a{constructor(t){this.target=t,this.isEnabled=!1}getTarget(){return this.target}}class d extends a{constructor(t,i,s,h){super(t),this.startEvent=(t=this._includeHover,e=this._rightMouseButton,i=this._doubleClick)=>{if(this.isEnabled)return;this._includeHover=t,this.rightMouseButton=e,this._doubleClick=i;const{target:s}=this;s.insetContainer.on(this.evMouseDown,this.onMouseDownImpl),this._rightMouseButton||s.insetContainer.on("touchstart",this.onMouseDownImpl),this._includeHover&&(s.insetContainer.on("mouseover",this.onMouseOverImpl),s.insetContainer.on("mouseout",this.onMouseOutImpl)),this.isEnabled=!0},this.stopEvent=()=>{if(!this.isEnabled)return;const{target:t}=this;this.bound&&(t.insetContainer.removeListener(this.evMouseUp,this.onMouseUpImpl),t.insetContainer.removeListener(this.evMouseUpOutside,this.onMouseUpOutsideImpl),this._rightMouseButton||(t.insetContainer.removeListener("touchend",this.onMouseUpImpl),t.insetContainer.removeListener("touchendoutside",this.onMouseUpOutsideImpl)),this.bound=!1),t.insetContainer.removeListener(this.evMouseDown,this.onMouseDownImpl),this._rightMouseButton||t.insetContainer.removeListener("touchstart",this.onMouseDownImpl),this._includeHover&&(t.insetContainer.removeListener("mouseover",this.onMouseOverImpl),t.insetContainer.removeListener("mouseout",this.onMouseOutImpl),t.insetContainer.removeListener("mousemove",this.onMouseMoveImpl),t.insetContainer.removeListener("touchmove",this.onMouseMoveImpl)),this.isEnabled=!1},this.onMouseDownImpl=t=>{const{target:e,evMouseUp:i,onMouseUpImpl:s,evMouseUpOutside:h,onMouseUpOutsideImpl:n,_rightMouseButton:r}=this;if(this.mouse.copyFrom(t.data.global),this.id=t.data.identifier,this.onPress.call(this.target,t,!0),this.bound||(e.insetContainer.on(i,s),e.insetContainer.on(h,n),r||(e.insetContainer.on("touchend",s),e.insetContainer.on("touchendoutside",n)),this.bound=!0),this._doubleClick){const i=performance.now();i-this.time<210?this.onClick.call(e,t):this.time=i}t.data.originalEvent.preventDefault()},this.onMouseUpCommonImpl=t=>{const{target:e,evMouseUp:i,onMouseUpImpl:s,evMouseUpOutside:h,onMouseUpOutsideImpl:n}=this;t.data.identifier===this.id&&(this.offset.set(t.data.global.x-this.mouse.x,t.data.global.y-this.mouse.y),this.bound&&(e.insetContainer.removeListener(i,s),e.insetContainer.removeListener(h,n),this._rightMouseButton||(e.insetContainer.removeListener("touchend",s),e.insetContainer.removeListener("touchendoutside",n)),this.bound=!1),this.onPress.call(e,t,!1))},this.onMouseUpImpl=t=>{t.data.identifier===this.id&&(this.onMouseUpCommonImpl(t),this.target.dragThreshold&&(this.movementX=Math.abs(this.offset.x),this.movementY=Math.abs(this.offset.y),Math.max(this.movementX,this.movementY)>this.target.dragThreshold)||this._doubleClick||this.onClick.call(this.target,t))},this.onMouseUpOutsideImpl=t=>{t.data.identifier===this.id&&this.onMouseUpCommonImpl(t)},this.onMouseOverImpl=t=>{this.ishover||(this.ishover=!0,this.target.insetContainer.on("mousemove",this.onMouseMoveImpl),this.target.insetContainer.on("touchmove",this.onMouseMoveImpl),this.onHover.call(this.target,t,!0))},this.onMouseOutImpl=t=>{this.ishover&&(this.ishover=!1,this.target.insetContainer.removeListener("mousemove",this.onMouseMoveImpl),this.target.insetContainer.removeListener("touchmove",this.onMouseMoveImpl),this.onHover.call(this.target,t,!1))},this.onMouseMoveImpl=t=>{this.onMove.call(this.target,t)},this.bound=!1,this.id=0,this.ishover=!1,this.mouse=new e.Point,this.offset=new e.Point,this.movementX=0,this.movementY=0,this._includeHover=void 0===i||i,this.rightMouseButton=void 0!==s&&s,this._doubleClick=void 0!==h&&h,t.interactive=!0,this.time=0,this.startEvent(),this.onHover=()=>null,this.onPress=()=>null,this.onClick=()=>null,this.onMove=()=>null}get rightMouseButton(){return this._rightMouseButton}set rightMouseButton(t){this._rightMouseButton=t,this.evMouseDown=this._rightMouseButton?"rightdown":"mousedown",this.evMouseUp=this._rightMouseButton?"rightup":"mouseup",this.evMouseUpOutside=this._rightMouseButton?"rightupoutside":"mouseupoutside"}}class l extends a{constructor(t){super(t),this.onDragStartImpl=t=>{const{target:e}=this;this.id=t.data.identifier,this.onPress(t,!0),this.isBound||(this.dragStart.copyFrom(t.data.global),e.stage.on("mousemove",this.onDragMoveImpl),e.stage.on("touchmove",this.onDragMoveImpl),e.stage.on("mouseup",this.onDragEndImpl),e.stage.on("mouseupoutside",this.onDragEndImpl),e.stage.on("touchend",this.onDragEndImpl),e.stage.on("touchendoutside",this.onDragEndImpl),e.stage.on("touchcancel",this.onDragEndImpl),this.isBound=!0),t.data.originalEvent.preventDefault()},this.onDragMoveImpl=t=>{if(t.data.identifier!==this.id)return;const{lastCursor:e,dragOffset:i,dragStart:s,target:h}=this;if(this.lastCursor.copyFrom(t.data.global),this.dragOffset.set(e.x-s.x,e.y-s.y),!this.isDragging){if(this.movementX=Math.abs(i.x),this.movementY=Math.abs(i.y),0===this.movementX&&0===this.movementY||Math.max(this.movementX,this.movementY)<h.dragThreshold)return;if(null!==h.dragRestrictAxis&&(this.cancel=!1,("x"===h.dragRestrictAxis&&this.movementY>this.movementX||"y"===h.dragRestrictAxis&&this.movementY<=this.movementX)&&(this.cancel=!0),this.cancel))return void this.onDragEndImpl(t);this.onDragStart(t),this.isDragging=!0}this.onDragMove(t,i)},this.onDragEndImpl=t=>{if(t.data.identifier!==this.id)return;const{target:e}=this;this.isBound&&(e.stage.removeListener("mousemove",this.onDragMoveImpl),e.stage.removeListener("touchmove",this.onDragMoveImpl),e.stage.removeListener("mouseup",this.onDragEndImpl),e.stage.removeListener("mouseupoutside",this.onDragEndImpl),e.stage.removeListener("touchend",this.onDragEndImpl),e.stage.removeListener("touchendoutside",this.onDragEndImpl),e.stage.removeListener("touchcancel",this.onDragEndImpl),this.isDragging=!1,this.isBound=!1,this.onDragEnd(t),this.onPress(t,!1))},this.isBound=!1,this.isDragging=!1,this.id=0,this.dragStart=new e.Point,this.dragOffset=new e.Point,this.lastCursor=new e.Point,this.movementX=0,this.movementY=0,this.cancel=!1,this.target.interactive=!0,this.onPress=()=>null,this.onDragStart=()=>null,this.onDragMove=()=>null,this.onDragEnd=()=>null,this.startEvent()}startEvent(){if(this.isEnabled)return;const{target:t}=this;t.insetContainer.on("mousedown",this.onDragStartImpl),t.insetContainer.on("touchstart",this.onDragStartImpl),this.isEnabled=!0}stopEvent(){if(!this.isEnabled)return;const{target:t}=this;this.isBound&&(t.stage.removeListener("mousemove",this.onDragMoveImpl),t.stage.removeListener("touchmove",this.onDragMoveImpl),t.stage.removeListener("mouseup",this.onDragEndImpl),t.stage.removeListener("mouseupoutside",this.onDragEndImpl),t.stage.removeListener("touchend",this.onDragEndImpl),t.stage.removeListener("touchendoutside",this.onDragEndImpl),this.isBound=!1),t.insetContainer.removeListener("mousedown",this.onDragStartImpl),t.insetContainer.removeListener("touchstart",this.onDragStartImpl),this.isEnabled=!1}}class u{constructor(t){this.target=t;for(const t of Object.keys(u.MANAGER_MAP))Object.defineProperty(this,t,{get(){return this[`_${t}`]||(this[`_${t}`]=new u.MANAGER_MAP[t](this.target)),this[`_${t}`]}})}}u.MANAGER_MAP={click:d,dnd:l};class c extends a{constructor(t,i=!0){super(t),this.onMouseScrollImpl=t=>{const{target:e,preventDefault:i,delta:s}=this;i&&event.preventDefault(),void 0!==t.deltaX?s.set(t.deltaX,t.deltaY):s.set(1===t.axis?60*t.detail:0,2===t.axis?60*t.detail:0),this.onMouseScroll.call(e,event,s)},this.onHoverImpl=t=>{const{onMouseScrollImpl:e}=this;this.bound||(document.addEventListener("mousewheel",e,!1),document.addEventListener("DOMMouseScroll",e,!1),this.bound=!0)},this.onMouseOutImpl=t=>{const{onMouseScrollImpl:e}=this;this.bound&&(document.removeEventListener("mousewheel",e),document.removeEventListener("DOMMouseScroll",e),this.bound=!1)},this.onMouseScroll=function(t,e){},this.bound=!1,this.delta=new e.Point,this.preventDefault=i,this.startEvent()}startEvent(){const{target:t,onHoverImpl:e,onMouseOutImpl:i}=this;t.contentContainer.on("mouseover",e),t.contentContainer.on("mouseout",i)}stopEvent(){const{target:t,onMouseScrollImpl:e,onHoverImpl:i,onMouseOutImpl:s}=this;this.bound&&(document.removeEventListener("mousewheel",e),document.removeEventListener("DOMMouseScroll",e),this.bound=!1),t.contentContainer.removeListener("mouseover",i),t.contentContainer.removeListener("mouseout",s)}}class g extends e.utils.EventEmitter{constructor(){super(),this.insetContainer=new e.Container,this.contentContainer=this.insetContainer.addChild(new e.Container),this.widgetChildren=[],this.stage=null,this.layoutMeasure=new n,this.initialized=!1,this.dragInitialized=!1,this.dropInitialized=!1,this.dirty=!0,this._oldWidth=-1,this._oldHeight=-1,this.pixelPerfect=!0,this._paddingLeft=0,this._paddingTop=0,this._paddingRight=0,this._paddingBottom=0,this._elevation=0,this.tint=0,this.blendMode=e.BLEND_MODES.NORMAL,this.draggable=!1,this.droppable=!1}update(){this._layoutDirty&&(console.log("here"),setTimeout(()=>{this._layoutDirty&&this.stage.measureAndLayout()},0))}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}getMeasuredWidth(){return this._measuredWidth}getMeasuredHeight(){return this._measuredHeight}onMeasure(e,i,s,h){const n=this.contentContainer.width+this.paddingHorizontal,r=this.contentContainer.height+this.paddingVertical;switch(s){case t.MeasureMode.EXACTLY:this._measuredWidth=e;break;case t.MeasureMode.UNBOUNDED:this._measuredWidth=n;break;case t.MeasureMode.AT_MOST:this._measuredWidth=Math.min(e,n)}switch(h){case t.MeasureMode.EXACTLY:this._measuredHeight=i;break;case t.MeasureMode.UNBOUNDED:this._measuredHeight=r;break;case t.MeasureMode.AT_MOST:this._measuredHeight=Math.min(i,r)}}measure(t,e,i,s){this.onMeasure(t,e,i,s)}onLayout(t,e=t,i=t,s=e,h=!0){this.layoutMeasure.left=t,this.layoutMeasure.top=e,this.layoutMeasure.right=i,this.layoutMeasure.bottom=s,this._width=i-t,this._height=s-e,this.background&&(this.background.x=0,this.background.y=0,this.background.width=i-t,this.background.height=s-e),this.insetContainer.x=t,this.insetContainer.y=e,this.contentContainer.x=this._paddingLeft,this.contentContainer.y=this._paddingTop,this._layoutDirty=!1}layout(t,e=t,i=t,s=e,h=!0){this.onLayout(t,e,i,s,h)}setLayoutOptions(t){return this.layoutOptions=t,this}get eventBroker(){return this._eventBroker||(this._eventBroker=new u(this)),this._eventBroker}get paddingLeft(){return this._paddingLeft}set paddingLeft(t){this._paddingLeft=t,this.dirty=!0}get paddingTop(){return this._paddingTop}set paddingTop(t){this._paddingTop=t,this.dirty=!0}get paddingRight(){return this._paddingRight}set paddingRight(t){this._paddingRight=t,this.dirty=!0}get paddingBottom(){return this._paddingBottom}set paddingBottom(t){this._paddingBottom=t,this.dirty=!0}get paddingHorizontal(){return this._paddingLeft+this._paddingRight}get paddingVertical(){return this._paddingTop+this._paddingBottom}get interactive(){return this.insetContainer.interactive}set interactive(t){this.insetContainer.interactive=!0,this.contentContainer.interactive=!0}get width(){return this._width}get height(){return this._height}get contentWidth(){return this._width-this.paddingHorizontal}get contentHeight(){return this._height-this.paddingVertical}get alpha(){return this.insetContainer.alpha}set alpha(t){this.insetContainer.alpha=t}setPadding(t,e=t,i=t,s=e){return this._paddingLeft=t,this._paddingTop=e,this._paddingRight=i,this._paddingBottom=s,this.dirty=!0,this}getBackground(){return this.background}setBackground(t){return this.background&&this.insetContainer.removeChild(this.background),"string"==typeof t&&(t=e.utils.string2hex(t)),"number"==typeof t&&(t=(new e.Graphics).beginFill(t).drawRect(0,0,1,1).endFill()),this.background=t,t&&(t.width=this.width,t.height=this.height,this.insetContainer.addChildAt(t,0)),t&&this._elevation&&this._dropShadow&&(this.background.filters||(this.background.filters=[]),this.background.filters.push(this._dropShadow)),this}getBackgroundAlpha(){return this.background?this.background.alpha:1}setBackgroundAlpha(t){return this.background||this.setBackground(16777215),this.background.alpha=t,this}getElevation(){return this._elevation}setElevation(t){if(this._elevation=t,0===t&&this._dropShadow){if(!this.background)return this;const t=this.background.filters.indexOf(this._dropShadow);t>0&&this.background.filters.splice(t,1)}else t>0&&(this._dropShadow||(this.background&&!this.background.filters&&(this.background.filters=[]),this._dropShadow=new i.DropShadowFilter({distance:t}),this.background&&this.background.filters.push(this._dropShadow)),this._dropShadow.distance=t);return this}requestLayout(){this._layoutDirty=!0}addChild(...t){for(let e=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.removeChild(i),i.parent=this,this.contentContainer.addChild(i.insetContainer),this.widgetChildren.push(i)}return this}removeChild(...t){for(let e=0;e<t.length;e++){const i=t[e],s=this.widgetChildren.indexOf(i);-1!==s&&(i.insetContainer.parent.removeChild(i.insetContainer),this.widgetChildren.splice(s,1),i.parent=null)}return this}makeDraggable(){return this.draggable=!0,this.initialized&&this.initDraggable(),this}clearDraggable(){this.dragInitialized&&(this.dragInitialized=!1,this.eventBroker.dnd.stopEvent())}initialize(){this.initialized||(this.draggable&&this.initDraggable(),this.droppable&&this.initDroppable(),this.initialized=!0)}initDraggable(){if(this.dragInitialized)return;this.dragInitialized=!0;const t=new e.Point,i=new e.Point,s=this.eventBroker.dnd,{insetContainer:n}=this;s.onDragStart=e=>{const i=h.add(this,e);!this.isDragging&&i&&(this.isDragging=!0,n.interactive=!1,t.copyFrom(n.position),this.emit("draggablestart",e))},s.onDragMove=(e,s)=>{this.isDragging&&(i.set(t.x+s.x,t.y+s.y),n.x=i.x,n.y=i.y,this.emit("draggablemove",e))},s.onDragEnd=e=>{this.isDragging&&(this.isDragging=!1,h.getItem(this),setTimeout(()=>{this.insetContainer.interactive=!0,this.insetContainer.position.copyFrom(t),this.emit("draggableend",e)},0))}}makeDroppable(){return this.droppable=!0,this.initialized&&this.initDroppable(),this}clearDroppable(){this.dropInitialized&&(this.dropInitialized=!1,this.contentContainer.removeListener("mouseup",this.onDrop),this.contentContainer.removeListener("touchend",this.onDrop))}initDroppable(){if(!this.dropInitialized){this.dropInitialized=!0;const t=this.contentContainer;this.contentContainer.interactive=!0,this.onDrop=t=>{const e=h.getEventItem(t,this.dropGroup);if(e&&e.isDragging){e.isDragging=!1,e.insetContainer.interactive=!0;const t=null!==this.droppableReparent?this.droppableReparent:self;t.container.toLocal(e.container.position,e.container.parent,e),t.container!=e.container.parent&&t.addChild(e)}},t.on("mouseup",this.onDrop),t.on("touchend",this.onDrop)}}static fromContent(t){if(t instanceof g)return t;const e=new g;return e.contentContainer.addChild(t),e}static resolveMeasuredDimen(e,i,s){return s===t.MeasureMode.EXACTLY?i:s===t.MeasureMode.AT_MOST?Math.min(i,e):e}}(o=t.ALIGN||(t.ALIGN={}))[o.LEFT=0]="LEFT",o[o.TOP=0]="TOP",o[o.MIDDLE=4081]="MIDDLE",o[o.CENTER=4081]="CENTER",o[o.RIGHT=1048561]="RIGHT",o[o.BOTTOM=1048561]="BOTTOM",o[o.NONE=4294967295]="NONE";class p{constructor(t=p.WRAP_CONTENT,e=p.WRAP_CONTENT){this.setWidth(t),this.setHeight(e),this.cache={}}setWidth(t){this.width=p.parseDimen(t)}setHeight(t){this.height=p.parseDimen(t)}get isWidthPredefined(){return this.width>1&&this.width<=p.MAX_DIMEN}get isHeightPredefined(){return this.height>1&&this.height<=p.MAX_DIMEN}get marginLeft(){return this._marginLeft||0}set marginLeft(t){this._marginLeft=t}get marginTop(){return this._marginTop||0}set marginTop(t){this._marginTop=t}get marginRight(){return this._marginRight||0}set marginRight(t){this._marginRight=t}get marginBottom(){return this._marginBottom||0}set marginBottom(t){this._marginBottom=t}setMargin(t,e,i,s){this._marginLeft=t,this._marginTop=e,this._marginRight=i,this._marginBottom=s}static parseDimen(t){if("string"==typeof t&&(t.endsWith("%")?t=parseFloat(t.replace("%",""))/100:t.endsWith("px")&&(t=parseFloat(t.replace("px",""))),"string"==typeof t||isNaN(t)))throw new Error("Width could not be parsed!");return t}}p.FILL_PARENT=4294967281,p.WRAP_CONTENT=4294967282,p.MAX_DIMEN=4294967280,p.DEFAULT=new p;class m extends p{constructor(t){super(t.width,t.height),this.x=t.x||0,this.y=t.y||0,this.anchor=t.anchor||m.DEFAULT_ANCHOR.clone()}}m.DEFAULT_ANCHOR=new e.Point(0,0),m.CENTER_ANCHOR=new e.Point(.5,.5);class f extends p{constructor(e){super(e.width,e.height),this.region=e.region||f.REGION_CENTER,this.horizontalAlign=e.horizontalAlign||t.ALIGN.LEFT,this.verticalAlign=e.verticalAlign||t.ALIGN.TOP}}f.REGION_LEFT=61425,f.REGION_TOP=61426,f.REGION_RIGHT=61427,f.REGION_BOTTOM=61428,f.REGION_CENTER=61429;class w{onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){const t=this.host,{contentWidth:e,contentHeight:i,widgetChildren:s}=t;for(let t=0,h=s.length;t<h;t++){const h=s[t],n=h.layoutOptions||p.DEFAULT;let r=n.x?n.x:0,o=n.y?n.y:0;Math.abs(r)<1&&(r*=e),Math.abs(o)<1&&(o*=i);const a=n.anchor||m.DEFAULT_ANCHOR,d=r-a.x*h.getMeasuredWidth(),l=o-a.y*h.getMeasuredHeight();h.layout(d,l,d+h.getMeasuredWidth(),l+h.getMeasuredHeight())}}onMeasure(t,e,i,s){this._measuredWidth=t,this._measuredHeight=e;const h=this.host.widgetChildren;for(let n=0,r=h.length;n<r;n++){const r=h[n],o=r.layoutOptions||p.DEFAULT,a=Math.abs(o.width)<1?o.width*t:o.width,d=Math.abs(o.height)<1?o.height*e:o.height,l=this.getChildMeasureMode(o.width,i),u=this.getChildMeasureMode(o.height,s);r.measure(a,d,l,u)}this._measuredWidth=this.measureWidthReach(t,i),this._measuredHeight=this.measureHeightReach(e,s),this.measureChildFillers()}getChildMeasureMode(e,i){return e===p.WRAP_CONTENT?i===t.MeasureMode.UNBOUNDED?t.MeasureMode.UNBOUNDED:t.MeasureMode.AT_MOST:i}measureWidthReach(e,i){if(i===t.MeasureMode.EXACTLY)return e;const s=this.host.widgetChildren;let h=0;for(let t=0,e=s.length;t<e;t++){const e=s[t],i=e.getMeasuredWidth(),n=e.layoutOptions||p.DEFAULT,r=n.x?n.x:0,o=n.anchor?n.anchor:m.DEFAULT_ANCHOR,a=Math.abs(r)<1?(1-o.x)*i/(1-r):r+i;h=Math.max(h,a)}return i===t.MeasureMode.AT_MOST&&(h=Math.min(e,h)),h}measureHeightReach(e,i){if(i===t.MeasureMode.EXACTLY)return e;const s=this.host.widgetChildren;let h=0;for(let t=0,e=s.length;t<e;t++){const e=s[t],i=e.getMeasuredHeight(),n=e.layoutOptions||p.DEFAULT,r=n.y?n.y:0,o=n.anchor?n.anchor:m.DEFAULT_ANCHOR,a=Math.abs(r)<1?(1-o.y)*i/(1-r):r+i;h=Math.max(h,a)}return i===t.MeasureMode.AT_MOST&&(h=Math.min(e,h)),h}measureChildFillers(){const e=this.host.widgetChildren;for(let i=0,s=e.length;i<s;i++){const s=e[i],h=s.layoutOptions||p.DEFAULT;let n=Math.abs(h.width)<1?h.width*this._measuredWidth:h.width,r=Math.abs(h.height)<1?h.height*this._measuredHeight:h.height;n===p.WRAP_CONTENT&&(n=s.getMeasuredWidth()),r===p.WRAP_CONTENT&&(r=s.getMeasuredHeight()),h.width!==p.FILL_PARENT&&h.height!==p.FILL_PARENT||s.measure(h.width===p.FILL_PARENT?this._measuredWidth:n,h.height===p.FILL_PARENT?this._measuredHeight:r,t.MeasureMode.EXACTLY,t.MeasureMode.EXACTLY)}}getMeasuredWidth(){return this._measuredWidth}getMeasuredHeight(){return this._measuredHeight}}class M extends g{useLayout(t){return this.layoutMgr&&this.layoutMgr.onDetach(),this.layoutMgr=t,t&&this.layoutMgr.onAttach(this),this}useDefaultLayout(){this.useLayout(new w)}onMeasure(t,e,i,s){super.onMeasure(t,e,i,s),0!==this.widgetChildren.length&&(this.layoutMgr||this.useDefaultLayout(),this.layoutMgr.onMeasure(t-this.paddingHorizontal,e-this.paddingVertical,i,s),this._measuredWidth=Math.max(this.measuredWidth,this.layoutMgr.getMeasuredWidth()),this._measuredHeight=Math.max(this.measuredHeight,this.layoutMgr.getMeasuredHeight()))}onLayout(t,e,i,s,h=!0){super.onLayout(t,e,i,s,h),0!==this.widgetChildren.length&&(this.layoutMgr||this.useDefaultLayout(),this.layoutMgr.onLayout())}}class v extends M{constructor(){super(),this.hitArea=new e.Rectangle,this.insetContainer.hitArea=this.hitArea}update(){super.update()}layout(t,e,i,s,h){super.layout(t,e,i,s,h),this.hitArea.width=this.width,this.hitArea.height=this.height}}class _ extends v{constructor(t={}){super(),this.bindEvents=()=>{this.stage.on("pointerdown",this.onDocumentPointerDownImpl),document.addEventListener("keydown",this.onKeyDownImpl)},this.clearEvents=()=>{this.stage.off("pointerdown",this.onDocumentPointerDownImpl),document.removeEventListener("keydown",this.onKeyDownImpl)},this.onKeyDownImpl=t=>{const e=this.stage.focusController;9===t.which&&e.useTab?(e.onTab(),t.preventDefault()):38===t.which&&e.useBack?(e.onBack(),t.preventDefault()):40===t.which&&e.useForward&&(e.onForward(),t.preventDefault()),this.emit("keydown")},this.onDocumentPointerDownImpl=()=>{this._isMousePressed||this.blur()},t.background&&super.setBackground(t.background),this._isFocused=!1,this._isMousePressed=!1,this.interactive=!0,this.tabIndex=t.tabIndex,this.tabGroup=t.tabGroup,this.insetContainer.on("pointerdown",()=>{this.focus(),this._isMousePressed=!0}),this.insetContainer.on("pointerup",()=>{this._isMousePressed=!1}),this.insetContainer.on("pointerupoutside",()=>{this._isMousePressed=!1})}focus(){this.isFocused||(this.stage.focusController.notifyFocus(this),this._isFocused=!0,this.bindEvents(),this.emit("focusChanged",!0),this.emit("focus"))}blur(){this._isFocused&&(this.stage.focusController.notifyBlur(),this._isFocused=!1,this.clearEvents(),this.emit("focusChanged",!1),this.emit("blur"))}get isFocused(){return this._isFocused}initialize(){super.initialize(),this.stage.focusController.in(this,this.tabIndex,this.tabGroup)}}class C extends g{constructor(t,i){super(),this.textDisplay=new e.Text(t,i),this.contentContainer.addChild(this.textDisplay)}update(){null!==this.tint&&(this.textDisplay.tint=this.tint),null!==this.blendMode&&(this.textDisplay.blendMode=this.blendMode)}get value(){return this.textDisplay.text}set value(t){this.textDisplay.text=t}get text(){return this.value}set text(t){this.value=t}}class x{getPosition(t){return t}}function T(t,e,i){const s=t,h=e&&i?3:i?1:2;this.getPosition=function(t){let e=1===h?1-t:2===h?t:t<.5?2*t:2*(1-t);return 1===s?e*=e:2===s?e*=e*e:3===s?e*=e*e*e:4===s&&(e*=e*e*e*e),1===h?1-e:2===h?e:t<.5?e/2:1-e/2}}T.prototype=Object.create(x.prototype),T.prototype.constructor=T;const b={},y=.5*Math.PI;function L(t){const e=Object.create(x.prototype);return e.getPosition=t,e}const E=new x;function I(t,e,i){return{easeIn:t,easeOut:e,easeInOut:i}}b.Linear=E,b.Power0={easeNone:E},b.Power1=b.Quad=I(new T(1,1,0),new T(1,0,1),new T(1,1,1)),b.Power2=b.Cubic=I(new T(2,1,0),new T(2,0,1),new T(2,1,1)),b.Power3=b.Quart=I(new T(3,1,0),new T(3,0,1),new T(3,1,1)),b.Power4=b.Quint=I(new T(4,1,0),new T(4,0,1),new T(4,1,1)),b.Bounce={BounceIn:L((function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)})),BounceOut:L((function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375})),BounceInOut:L((function(t){const e=t<.5;return(t=e?1-2*t:2*t-1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}))},b.Circ={CircIn:L((function(t){return-(Math.sqrt(1-t*t)-1)})),CircOut:L((function(t){return Math.sqrt(1-(t-=1)*t)})),CircInOut:L((function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}))},b.Expo={ExpoIn:L((function(t){return Math.pow(2,10*(t-1))-.001})),ExpoOut:L((function(t){return 1-Math.pow(2,-10*t)})),ExpoInOut:L((function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}))},b.Sine={SineIn:L((function(t){return 1-Math.cos(t*y)})),SineOut:L((function(t){return Math.sin(t*y)})),SineInOut:L((function(t){return-.5*(Math.cos(Math.PI*t)-1)}))};const A={Lerp:(t,e,i)=>(i>1?i=1:i<0&&(i=0),t+(e-t)*i),Round(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i},componentToHex(t){const e=t.toString(16);return 1==e.length?`0${e}`:e},rgbToHex(t,e,i){return`#${this.componentToHex(t)}${this.componentToHex(e)}${this.componentToHex(i)}`},rgbToNumber:(t,e,i)=>65536*t+256*e+i,numberToRgb:t=>({r:Math.floor(t/65536),g:Math.floor(t/256)%256,b:t%256}),hexToRgb(t){if(null===t&&(t=16777215),!isNaN(t))return this.numberToRgb(t);t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,i,s){return e+e+i+i+s+s}));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}};class k extends g{constructor(t){super(),this.percentValue=0,this._disabled=!1,this.fill=t.fill||null,this.percentValue=this._minValue,this._minValue=t.minValue||0,this._maxValue=t.maxValue||100,this.decimals=t.decimals||0,this.orientation=t.orientation||k.HORIZONTAL,this.onValueChange=t.onValueChange||null,this.onValueChanging=t.onValueChanging||null,this.value=t.value||50,this.track=g.fromContent(t.track||(this.orientation===k.HORIZONTAL?k.DEFAULT_HORIZONTAL_TRACK.clone():k.DEFAULT_VERTICAL_TRACK.clone())),this.handle=g.fromContent(t.handle||k.DEFAULT_HANDLE.clone()),this.addChild(this.track,this.handle),this._localCursor=new e.Point,this.handle.contentContainer.buttonMode=!0}initialize(){super.initialize();let t,e=0;const i=()=>{this.emit("change",this.value),this._lastChange!=this.value&&(this._lastChange=this.value,"function"==typeof this.onValueChange&&this.onValueChange(this.value))},s=()=>{this.emit("changing",this.value),this._lastChanging!=this.value&&(this._lastChanging=this.value,"function"==typeof this.onValueChanging&&this.onValueChanging(this.value))},h=(t,e)=>{this.percentValue=this.getValueAtPhysicalPosition(t),this.layoutHandle(),s()},n=this.handle.eventBroker.dnd;n.onPress=t=>{t.stopPropagation()},n.onDragStart=()=>{e=this.percentValue,t=this.orientation===k.HORIZONTAL?this.track.width:this.track.height},n.onDragMove=(i,h)=>{this.percentValue=Math.max(0,Math.min(1,e+(this.orientation===k.HORIZONTAL?h.x:h.y)/t)),s(),this.layoutHandle()},n.onDragEnd=()=>{i(),this.layoutHandle()};const r=this.track.eventBroker.dnd;r.onPress=(t,e)=>{e&&h(t.data.global),t.stopPropagation()},r.onDragMove=t=>{h(t.data.global)},r.onDragEnd=()=>{i()},this.layoutHandle()}get value(){return A.Round(A.Lerp(this._minValue,this._maxValue,this.percentValue),this.decimals)}set value(t){if(t!==this.value){if(isNaN(t))throw new Error("Cannot use NaN as a value");this.percentValue=(Math.max(this._minValue,Math.min(this._maxValue,t))-this._minValue)/(this._maxValue-this._minValue),"function"==typeof this.onValueChange&&this.onValueChange(this.value),"function"==typeof this.onValueChanging&&this.onValueChanging(this.value),this.handle&&this.initialized&&this.layoutHandle()}}get minValue(){return this._minValue}set minValue(t){this._minValue=t,this.update()}get maxValue(){return this._maxValue}set maxValue(t){this._maxValue=t,this.update()}get disabled(){return this._disabled}set disabled(t){t!==this._disabled&&(this._disabled=t,this.handle.contentContainer.buttonMode=!t,this.handle.contentContainer.interactive=!t,this.track.contentContainer.interactive=!t)}getPhysicalRange(){return this.orientation===k.HORIZONTAL?this.contentWidth-this.handle.getMeasuredWidth():this.contentHeight-this.handle.getMeasuredHeight()}getValueAtPhysicalPosition(t){const e=this.contentContainer.toLocal(t,null,this._localCursor,!0);let i,s;if(this.orientation===k.HORIZONTAL){const t=this.handle.getMeasuredWidth();i=e.x-this.paddingLeft-t/4,s=this.contentWidth-t}else{const t=this.handle.getMeasuredHeight();i=e.y-this.paddingTop-t/4,s=this.contentHeight-t}return i/s}layoutHandle(){const t=this.handle,e=t.getMeasuredWidth(),i=t.getMeasuredHeight();let s,h,n=this.width-this.paddingHorizontal,r=this.height-this.paddingVertical;this.orientation===k.HORIZONTAL?(n-=e,h=(r-i)/2,s=n*this.percentValue):(r-=i,s=(n-e)/2,h=r*this.percentValue),t.layout(s,h,s+e,h+i)}onMeasure(e,i,s,h){const n=(this.orientation===k.HORIZONTAL?this._maxValue-this._minValue:Math.max(this.handle.contentContainer.width,this.track.contentContainer.width))+this.paddingHorizontal,r=(this.orientation===k.VERTICAL?this._maxValue-this._minValue:Math.max(this.handle.contentContainer.height,this.track.contentContainer.height))+this.paddingVertical;switch(s){case t.MeasureMode.EXACTLY:this._measuredWidth=e;break;case t.MeasureMode.UNBOUNDED:this._measuredWidth=n;break;case t.MeasureMode.AT_MOST:this._measuredWidth=Math.min(e,n)}switch(h){case t.MeasureMode.EXACTLY:this._measuredHeight=i;break;case t.MeasureMode.UNBOUNDED:this._measuredHeight=r;break;case t.MeasureMode.AT_MOST:this._measuredHeight=Math.min(i,r)}}onLayout(e,i,s,h,n){super.onLayout(e,i,s,h,n);const{handle:r,track:o}=this;o.layout(0,0,this.width-this.paddingHorizontal,this.height-this.paddingVertical),o.insetContainer.width=o.width,o.insetContainer.height=o.height,r.measure(this.width,this.height,t.MeasureMode.AT_MOST,t.MeasureMode.AT_MOST),this.layoutHandle()}}k.DEFAULT_HORIZONTAL_TRACK=(new e.Graphics).beginFill(16777215,1).drawRect(0,0,16,16).endFill().lineStyle(1,0,.7,1,!0).moveTo(1,8).lineTo(15,8),k.DEFAULT_VERTICAL_TRACK=(new e.Graphics).beginFill(16777215,1).drawRect(0,0,16,16).endFill().lineStyle(1,0,.7,1,!0).moveTo(8,1).lineTo(8,15),k.DEFAULT_HANDLE=(new e.Graphics).beginFill(0).drawCircle(16,16,8).endFill().beginFill(0,.5).drawCircle(16,16,16).endFill(),k.HORIZONTAL=4085,k.VERTICAL=4094;const D=[],O=[],R={},H={};let N=1;class P{constructor(t){this.object=t,this.tweens={},this.active=!1,this.onUpdate=null}}class S{constructor(){this._ready=!1,this.obj=null,this.parent=null,this.key="",this.time=0,this.callback=null,this.currentTime=0}remove(){this._ready=!0,delete this.parent.tweens[this.key],Object.keys(this.parent.tweens).length||(this.parent.active=!1,this.parent.onUpdate=null,delete H[this.obj._tweenObjectId])}set(t,e,i){this.obj=t.object,this.obj._currentCallbackID?this.obj._currentCallbackID++:this.obj._currentCallbackID=1,this.time=i,this.parent=t,this.callback=e,this._ready=!1,this.key=`cb_${this.obj._currentCallbackID}`,this.currentTime=0,this.parent.active||(this.parent.active=!0,H[this.obj._tweenObjectId]=this.parent)}update(t){this.currentTime+=t,this.currentTime>=this.time&&(this.remove(),this.callback.call(this.parent))}}class B{constructor(){this._ready=!1,this.parent=null,this.obj=null,this.key="",this.from=0,this.to=0,this.time=0,this.ease=0,this.currentTime=0,this.t=0,this.isColor=!1}remove(){this._ready=!0,delete this.parent.tweens[this.key],Object.keys(this.parent.tweens).length||(this.parent.active=!1,delete H[this.obj._tweenObjectId])}set(t,e,i,s,h,n){this.isColor=isNaN(i)&&"#"===i[0]||isNaN(s)&&"#"===s[0],this.parent=t,this.obj=t.object,this.key=e,this.surfix=function(t){if(isNaN(t)&&-1!==t.indexOf("%"))return"%"}(s),this.isColor?(this.to=A.hexToRgb(s),this.from=A.hexToRgb(i),this.currentColor={r:this.from.r,g:this.from.g,b:this.from.b}):(this.to=function(t){if(!isNaN(t))return t;if(isNaN(t)&&-1!==t.indexOf("%"))return parseFloat(t.replace("%",""))}(s),this.from=function(t,e,i,s){if(!isNaN(t)&&!isNaN(e))return t;if(isNaN(t)&&isNaN(e)&&-1!==t.indexOf("%")&&-1!==e.indexOf("%"))return parseFloat(t.replace("%",""));if(isNaN(t)&&!isNaN(e)&&-1!==t.indexOf("%"))return-1!==W.indexOf(s)?i.parent._width*(.01*parseFloat(t.replace("%",""))):-1!==F.indexOf(s)?i.parent._height*(.01*parseFloat(t.replace("%",""))):0;if(!isNaN(t)&&isNaN(e)&&-1!==e.indexOf("%"))return-1!==W.indexOf(s)?t/i.parent._width*100:-1!==F.indexOf(s)?t/i.parent._height*100:0;return 0}(i,s,this.obj,e)),this.time=h,this.currentTime=0,this.ease=n,this._ready=!1,this.parent.active||(this.parent.active=!0,H[this.obj._tweenObjectId]=this.parent)}update(t){if(this.currentTime+=t,this.t=Math.min(this.currentTime,this.time)/this.time,this.ease&&(this.t=this.ease.getPosition(this.t)),this.isColor)this.currentColor.r=Math.round(A.Lerp(this.from.r,this.to.r,this.t)),this.currentColor.g=Math.round(A.Lerp(this.from.g,this.to.g,this.t)),this.currentColor.b=Math.round(A.Lerp(this.from.b,this.to.b,this.t)),this.obj[this.key]=A.rgbToNumber(this.currentColor.r,this.currentColor.g,this.currentColor.b);else{const t=A.Lerp(this.from,this.to,this.t);this.obj[this.key]=this.surfix?t+this.surfix:t}this.currentTime>=this.time&&this.remove()}}const W=["width","minWidth","maxWidth","anchorLeft","anchorRight","left","right","x"],F=["height","minHeight","maxHeight","anchorTop","anchorBottom","top","bottom","y"];function V(t){t._tweenObjectId||(t._tweenObjectId=N,N++);let e=R[t._tweenObjectId];return e||(e=R[t._tweenObjectId]=new P(t)),e}function G(){for(let t=0;t<D.length;t++)if(D[t]._ready)return D[t];const t=new B;return D.push(t),t}function U(){for(let t=0;t<O.length;t++)if(O[t]._ready)return O[t];const t=new S;return O.push(t),t}const X={to(t,e,i,s){const h=V(t);let n=null;for(const r in i)if("onComplete"!==r)if("onUpdate"!==r){if(e){const n=i[r]===t[r];if(void 0===t[r])continue;n?h.tweens[r]&&h.tweens[r].remove():(h.tweens[r]||(h.tweens[r]=G()),h.tweens[r].set(h,r,t[r],i[r],e,s))}}else n=i[r];else{const t=U();t.set(h,i[r],e),h.tweens[t.key]=t}e?h.onUpdate=n:this.set(t,i)},from(t,e,i,s){const h=V(t);let n=null;for(const r in i)if("onComplete"!==r)if("onUpdate"!==r){if(e){const n=i[r]==t[r];if(void 0===t[r])continue;n?h.tweens[r]&&h.tweens[r].remove():(h.tweens[r]||(h.tweens[r]=G()),h.tweens[r].set(h,r,i[r],t[r],e,s))}}else n=i[r];else{const t=U();t.set(h,i[r],e),h.tweens[t.key]=t}e?h.onUpdate=n:this.set(t,i)},fromTo(t,e,i,s,h){const n=V(t);let r=null;for(const o in s)if("onComplete"!==o)if("onUpdate"!==o){if(e){const r=i[o]==s[o];if(void 0===t[o]||void 0===i[o])continue;r?(n.tweens[o]&&n.tweens[o].remove(),t[o]=s[o]):(n.tweens[o]||(n.tweens[o]=G()),n.tweens[o].set(n,o,i[o],s[o],e,h))}}else r=s[o];else{const t=U();t.set(n,s[o],e),n.tweens[t.key]=t}e?n.onUpdate=r:this.set(t,s)},set(t,e){const i=V(t);for(const s in e)void 0!==t[s]&&(i.tweens[s]&&i.tweens[s].remove(),t[s]=e[s])},_update(t){for(const e in H){const i=H[e];for(const e in i.tweens)i.tweens[e].update(t);i.onUpdate&&i.onUpdate.call(i.object,t)}}};class z extends k{constructor(t){super({track:t.track||z.DEFAULT_TRACK.clone(),handle:t.handle||z.DEFAULT_HANDLE.clone(),fill:null,orientation:t.orientation,minValue:0,maxValue:1}),this.scrollingContainer=t.scrollingContainer,this.autohide=t.autohide,this._hidden=!1}initialize(){super.initialize(),this.decimals=3,this.on("changing",()=>{this.scrollingContainer.forcePctPosition(this.orientation===k.HORIZONTAL?"x":"y",this.percentValue)}),this.on("change",()=>{this.scrollingContainer.setScrollPosition()})}toggleHidden(t){this.autohide&&(t&&!this._hidden?(X.to(this,.2,{alpha:0}),this._hidden=!0):!t&&this._hidden&&(X.to(this,.2,{alpha:1}),this._hidden=!1))}}z.DEFAULT_TRACK=(new e.Graphics).beginFill(16777215).drawRect(0,0,8,8).endFill(),z.DEFAULT_HANDLE=(new e.Graphics).beginFill(0).drawCircle(8,8,4).endFill().beginFill(0,.5).drawCircle(8,8,8).endFill();const{REGION_LEFT:Y,REGION_TOP:j,REGION_RIGHT:K,REGION_BOTTOM:$,REGION_CENTER:Z}=f,{FILL_PARENT:q}=p,{EXACTLY:Q,AT_MOST:J}=t.MeasureMode;class tt{constructor(){this.leftWidgets=[],this.topWidgets=[],this.rightWidgets=[],this.bottomWidgets=[],this.centerWidgets=[]}onAttach(t){this.host=t}onDetach(){this.host=null,this.clearMeasureCache(),this.clearRegions()}onLayout(){this.layoutChildren(this.leftWidgets,0,this.measuredTopHeight,this.measuredLeftWidth,this.measuredCenterHeight),this.layoutChildren(this.topWidgets,0,0,this.measuredWidth,this.measuredTopHeight),this.layoutChildren(this.rightWidgets,this.measuredWidth-this.measuredRightWidth,this.measuredTopHeight,this.measuredRightWidth,this.measuredCenterHeight),this.layoutChildren(this.bottomWidgets,0,this.measuredTopHeight+this.measuredCenterHeight,this.measuredWidth,this.measuredBottomHeight),this.layoutChildren(this.centerWidgets,this.measuredLeftWidth,this.measuredTopHeight,this.measuredCenterWidth,this.measuredCenterHeight)}layoutChildren(e,i,s,h,n){var r,o;for(let a=0,d=e.length;a<d;a++){const d=e[a];let l=0,u=0;switch(null===(r=d.layoutOptions)||void 0===r?void 0:r.horizontalAlign){case t.ALIGN.CENTER:l=(h-d.getMeasuredWidth())/2;break;case t.ALIGN.RIGHT:l=h-d.getMeasuredWidth();break;default:l=0}switch(null===(o=d.layoutOptions)||void 0===o?void 0:o.verticalAlign){case t.ALIGN.CENTER:u=(n-d.getMeasuredHeight())/2;break;case t.ALIGN.BOTTOM:u=n-d.getMeasuredHeight();break;default:u=0}l+=i,u+=s,d.layout(l,u,l+d.getMeasuredWidth(),u+d.getMeasuredHeight(),!0)}}onMeasure(e,i,s,h){this.indexRegions(),this.clearMeasureCache();const n=s===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s,r=h===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s;let[o,a,,d]=this.measureChildren(this.topWidgets,e,i,n,r),[l,u,,c]=this.measureChildren(this.bottomWidgets,e,i,n,r),[g,p,m,f]=this.measureChildren(this.centerWidgets,e,i,n,h),[w,,M]=this.measureChildren(this.leftWidgets,e,p,n,t.MeasureMode.AT_MOST),[v,,_]=this.measureChildren(this.rightWidgets,e,p,n,t.MeasureMode.AT_MOST);const C=w+v+g,x=Math.max(o,l,C),T=a+u+p;if(s===t.MeasureMode.EXACTLY?this.measuredWidth=e:s===t.MeasureMode.AT_MOST?this.measuredWidth=Math.min(x,e):this.measuredWidth=x,h===t.MeasureMode.EXACTLY?this.measuredHeight=i:h===t.MeasureMode.AT_MOST?this.measuredHeight=Math.min(T,i):this.measuredHeight=T,o=this.measuredWidth,l=this.measuredWidth,T>this.measuredHeight){const t=d+f+c;if(t<this.measuredHeight){const e=(this.measuredHeight-t)/(T-t);a=d+(a-d)*e,u=c+(u-c)*e,p=f+(p-f)*e}else{const t=this.measuredHeight/T;a*=t,u*=t,p*=t}}if(x>this.measuredWidth){const t=M+m+_;if(t<this.measuredWidth){const e=(this.measuredWidth-t)/(x-t);w=M+(w-M)*e,g=m+(g-m)*e,v=_+(v-_)*e}else{const t=this.measuredWidth/x;w*=t,g*=t,v*=t}}this.measuredLeftWidth=w,this.measuredRightWidth=v,this.measuredCenterWidth=g,this.measuredTopHeight=a,this.measuredBottomHeight=u,this.measuredCenterHeight=p,this.fitChildren(this.leftWidgets,this.measuredLeftWidth,this.measuredCenterHeight),this.fitChildren(this.topWidgets,this.measuredWidth,this.measuredTopHeight),this.fitChildren(this.rightWidgets,this.measuredRightWidth,this.measuredCenterHeight),this.fitChildren(this.bottomWidgets,this.measuredWidth,this.measuredBottomHeight),this.fitChildren(this.centerWidgets,this.measuredCenterWidth,this.measuredCenterHeight)}measureChildren(t,e,i,s,h){let n=0,r=0,o=0,a=0;for(let d=0,l=t.length;d<l;d++){const l=t[d],u=l.layoutOptions||p.DEFAULT;let c=e,g=i,m=s,f=h;u.width<=p.MAX_DIMEN&&(c=u.width,m=Q,o=Math.max(o,c)),u.height<=p.MAX_DIMEN&&(g=u.height,f=Q,a=Math.max(a,g)),l.measure(c,g,m,f),n=Math.max(n,l.getMeasuredWidth()),r=Math.max(r,l.getMeasuredHeight())}return[n,r,o,a]}fitChildren(t,e,i){var s,h,n,r;for(let o=0,a=t.length;o<a;o++){const a=t[o];if(!(a.getMeasuredWidth()<=e&&a.getMeasuredHeight()<=i&&a.getMeasuredWidth()>0&&a.getMeasuredHeight()>0&&(null===(s=a.layoutOptions)||void 0===s?void 0:s.width)!==q&&(null===(h=a.layoutOptions)||void 0===h?void 0:h.height)!==q)&&(e>0&&i>0)){const t=(null===(n=a.layoutOptions)||void 0===n?void 0:n.width)===q?Q:J,s=(null===(r=a.layoutOptions)||void 0===r?void 0:r.height)===q?Q:J;a.measure(e,i,t,s)}}}indexRegions(){this.clearRegions();const{widgetChildren:t}=this.host;for(let e=0,i=t.length;e<i;e++){const i=t[e];switch((i.layoutOptions||p.DEFAULT).region||Z){case Y:this.leftWidgets.push(i);break;case j:this.topWidgets.push(i);break;case K:this.rightWidgets.push(i);break;case $:this.bottomWidgets.push(i);break;default:this.centerWidgets.push(i)}}}clearRegions(){this.leftWidgets.length=0,this.topWidgets.length=0,this.rightWidgets.length=0,this.bottomWidgets.length=0}clearMeasureCache(){this.measuredLeftWidth=0,this.measuredRightWidth=0,this.measuredCenterWidth=0,this.measuredTopHeight=0,this.measuredBottomHeight=0,this.measuredCenterHeight=0}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}}class et extends v{constructor(i={}){if(super(),this.forcePctPosition=(t,e)=>{const i=this.getInnerBounds(),s=this.innerContainer.insetContainer;this.scrollX&&"x"===t&&(s.position[t]=-(i.width-this.width)*e),this.scrollY&&"y"===t&&(s.position[t]=-(i.height-this.height)*e),this.scrollPosition[t]=this.targetPosition[t]=s.position[t]},this.focusPosition=t=>{const e=this.getInnerBounds(),i=this.innerContainer.insetContainer;let s;if(this.scrollX){const h=Math.max(0,Math.min(e.width,t.x));h+i.x>this.width?(s=h-this.width,i.x=-s):h+i.x<0&&(s=h+i.x,i.x-=s)}if(this.scrollY){const h=Math.max(0,Math.min(e.height,t.y));h+i.y>this.height?(s=h-this.height,i.y=-s):h+i.y<0&&(s=h+i.y,i.y-=s)}this.lastPosition.copyFrom(i.position),this.targetPosition.copyFrom(i.position),this.scrollPosition.copyFrom(i.position),this.updateScrollBars()},this.setScrollPosition=t=>{t&&this.scrollVelocity.copyFrom(t);const i=this.innerContainer.insetContainer;this.animating||(this.animating=!0,this.lastPosition.copyFrom(i.position),this.targetPosition.copyFrom(i.position),e.Ticker.shared.add(this.updateScrollPosition))},this.updateScrollPosition=t=>{this.stop=!0,this.scrollX&&this.updateDirection("x",t),this.scrollY&&this.updateDirection("y",t),this.stop&&(e.Ticker.shared.remove(this.updateScrollPosition),this.animating=!1),this.updateScrollBars()},this.updateDirection=(t,e)=>{const i=this.getInnerBounds(),{scrollPosition:s,scrollVelocity:h,targetPosition:n,lastPosition:r}=this,o=this.innerContainer.insetContainer;let a;if(a="y"===t?Math.round(Math.min(0,this.height-i.height)):Math.round(Math.min(0,this.width-i.width)),this.scrolling||0===Math.round(h[t])||(n[t]+=h[t],h[t]=A.Lerp(h[t],0,(5+2.5/Math.max(this.softness,.01))*e),n[t]>0?n[t]=0:n[t]<a&&(n[t]=a)),!this.scrolling&&0===Math.round(h[t])&&(o[t]>0||o[t]<a)){const i=this.scrollPosition[t]>0?0:a;s[t]=A.Lerp(s[t],i,(40-30*this.softness)*e),this.stop=!1}else(this.scrolling||0!==Math.round(h[t]))&&(this.scrolling&&(h[t]=this.scrollPosition[t]-r[t],r.copyFrom(s)),n[t]>0?(h[t]=0,s[t]=100*this.softness*(1-Math.exp(n[t]/-200))):n[t]<a?(h[t]=0,s[t]=a-100*this.softness*(1-Math.exp((a-n[t])/-200))):s[t]=n[t],this.stop=!1);o.position[t]=Math.round(s[t])},this.mask=new e.Graphics,this.innerContainer=new v,this.innerBounds=new e.Rectangle,super.addChild(this.innerContainer),this.contentContainer.addChild(this.mask),this.contentContainer.mask=this.mask,this.scrollX=void 0!==i.scrollX&&i.scrollX,this.scrollY=void 0!==i.scrollY&&i.scrollY,this.dragScrolling=void 0===i.dragScrolling||i.dragScrolling,this.softness=void 0!==i.softness?Math.max(Math.min(i.softness||0,1),0):.5,this.radius=i.radius||0,this.expandMask=i.expandMask||0,this.overflowY=i.overflowY||0,this.overflowX=i.overflowX||0,this.scrollVelocity=new e.Point,this.scrollPosition=new e.Point,this.targetPosition=new e.Point,this.lastPosition=new e.Point,this.useLayout(new tt),this.animating=!1,this.scrolling=!1,this.scrollBars=[],i.scrollBars&&this.scrollX){const e=new z({orientation:z.HORIZONTAL,scrollingContainer:this,minValue:0,maxValue:1}).setLayoutOptions(new f({width:p.FILL_PARENT,height:p.WRAP_CONTENT,region:f.REGION_BOTTOM,horizontalAlign:t.ALIGN.CENTER,verticalAlign:t.ALIGN.BOTTOM})).setBackground(255).setBackgroundAlpha(.8);super.addChild(e),this.scrollBars.push(e)}if(i.scrollBars&&this.scrollY){const e=new z({orientation:z.VERTICAL,scrollingContainer:this,minValue:0,maxValue:1}).setLayoutOptions(new f({width:p.WRAP_CONTENT,height:p.FILL_PARENT,region:f.REGION_RIGHT,horizontalAlign:t.ALIGN.RIGHT,verticalAlign:t.ALIGN.CENTER})).setBackground(255).setBackgroundAlpha(.8);super.addChild(e),this.scrollBars.push(e)}this.boundCached=0}update(){if(super.update(),this.lastWidth!==this.width||this.lastHeight!==this.height){const t=this.expandMask;this.mask.clear(),this.mask.lineStyle(0),this.mask.beginFill(16777215,1),0===this.radius?this.mask.drawRect(-t,-t,this.width+t,this.height+t):this.mask.drawRoundedRect(-t,-t,this.width+t,this.height+t,this.radius),this.mask.endFill(),this.lastWidth=this.width,this.lastHeight=this.height}}addScrollBar(t){return super.addChild(t),this.scrollBars.push(t),this}addChild(...t){for(let e=0;e<t.length;e++)this.innerContainer.addChild(t[e]);return this.getInnerBounds(!0),this}updateScrollBars(){for(let t=0,e=this.scrollBars.length;t<e;t++){const e=this.scrollBars[t];if(e.orientation===k.HORIZONTAL){const t=this.getPercentPosition("x");e.value=t}else if(e.orientation===k.VERTICAL){const t=this.getPercentPosition("y");e.value=t}}}getInnerBounds(t){return(t||performance.now()-this.boundCached>1e3)&&(this.innerContainer.insetContainer.getLocalBounds(this.innerBounds),this.innerBounds.height=this.innerBounds.y+this.innerContainer.height||0,this.innerBounds.width=this.innerBounds.x+this.innerContainer.width||0,this.boundCached=performance.now()),this.innerBounds}initialize(){super.initialize(),(this.scrollX||this.scrollY)&&this.initScrolling()}initScrolling(){const t=this.innerContainer.insetContainer,i=new e.Point,{scrollPosition:s,targetPosition:h}=this;if(this.dragScrolling){const e=this.eventBroker.dnd;e.onDragStart=e=>{this.scrolling||(i.copyFrom(t.position),s.copyFrom(t.position),this.scrolling=!0,this.setScrollPosition(),this.emit("scrollstart",e))},e.onDragMove=(t,e)=>{this.scrollX&&(h.x=i.x+e.x),this.scrollY&&(h.y=i.y+e.y),this.setScrollPosition()},e.onDragEnd=t=>{this.scrolling&&(this.scrolling=!1,this.emit("scrollend",t))}}const n=new e.Point;new c(this,!0).onMouseScroll=(t,e)=>{n.set(.2*-e.x,.2*-e.y),this.setScrollPosition(n)},this.updateScrollBars()}getPercentPosition(t){const e=this.getInnerBounds(),i=this.innerContainer.insetContainer;return"x"===t?i.x/(this.width-e.width):"y"===t?i.y/(this.height-e.height):0}}class it extends g{constructor(t){super(),this.spriteDisplay=new e.Sprite(t),this.contentContainer.addChild(this.spriteDisplay)}update(){null!==this.tint&&(this.spriteDisplay.tint=this.tint),null!==this.blendMode&&(this.spriteDisplay.blendMode=this.blendMode)}static fromImage(t){return new it(new e.Texture(new e.BaseTexture(t)))}}class ht extends e.utils.EventEmitter{constructor(t){super(),this.stage=t}}class nt extends e.Container{constructor(t,i){super(),this.__width=t,this.__height=i,this.minWidth=0,this.minHeight=0,this.widgetChildren=[],this.interactive=!0,this.stage=this,this.hitArea=new e.Rectangle(0,0,0,0),this.initialized=!0,this.resize(t,i),this._checkBoxGroupCtl=new nt.CHECK_BOX_GROUP_CONTROLLER(this),this._focusCtl=new nt.FOCUS_CONTROLLER(this)}measureAndLayout(){this.background&&(this.background.width=this.width,this.background.height=this.height);for(let e=0,i=this.widgetChildren.length;e<i;e++){const i=this.widgetChildren[e],s=i.layoutOptions||p.DEFAULT,h=s.width<p.MAX_DIMEN?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST,n=s.height<p.MAX_DIMEN?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST,r=Math.abs(s.width)<1?s.width*this.width:s.width,o=Math.abs(s.height)<1?s.height*this.height:s.height;i.measure(h===t.MeasureMode.EXACTLY?r:this.width,n===t.MeasureMode.EXACTLY?o:this.height,h,n);let a=s.x?s.x:0,d=s.y?s.y:0;Math.abs(a)<1&&(a*=this.width),Math.abs(d)<1&&(d*=this.height);const l=s.anchor||m.DEFAULT_ANCHOR,u=a-l.x*i.getMeasuredWidth(),c=d-l.y*i.getMeasuredHeight();i.layout(u,c,u+i.getMeasuredWidth(),c+i.getMeasuredHeight(),!0)}}getBackground(){return this.background}setBackground(t){this.background&&super.removeChild(this.background),this.background=t,t&&(super.addChildAt(t,0),this.background.width=this.width,this.background.height=this.height)}update(t){this.emit("preupdate",this);for(let e=0,i=t.length;e<i;e++){const i=t[e];i.stage=this,i.initialized||i.initialize(),this.update(i.widgetChildren),i.update()}this.emit("postupdate",this)}render(t){this.update(this.widgetChildren),super.render(t)}addChild(t){const e=arguments.length;if(e>1)for(let t=0;t<e;t++)this.addChild(arguments[t]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.widgetChildren.push(t),super.addChild(t.insetContainer);this.measureAndLayout()}removeChild(t){const e=arguments.length;if(e>1)for(let t=0;t<e;t++)this.removeChild(arguments[t]);else{super.removeChild(t.insetContainer);const e=this.widgetChildren.indexOf(t);-1!==e&&(this.children.splice(e,1),t.parent=null)}this.measureAndLayout()}resize(t,e){if(isNaN(e)||(this.__height=e),isNaN(t)||(this.__width=t),this.minWidth||this.minHeight){let i=1,s=1;t&&t<this.minWidth&&(i=this.minWidth/t),e&&e<this.minHeight&&(s=this.minHeight/e),i>s&&i>1?(this.scale.set(1/i),this.__height*=i,this.__width*=i):s>1?(this.scale.set(1/s),this.__width*=s,this.__height*=s):1!==this.scale.x&&this.scale.set(1)}this.hitArea&&(this.hitArea.width=this.__width,this.hitArea.height=this.__height);for(let t=0;t<this.widgetChildren.length;t++)this.widgetChildren[t].updatesettings(!0,!1);this.measureAndLayout()}get width(){return this.__width}set width(t){isNaN(t)||(this.__width=t,this.resize())}get height(){return this.__height}set height(t){isNaN(t)||(this.__height=t,this.resize())}get checkBoxGroupController(){return this._checkBoxGroupCtl}get focusController(){return this._focusCtl}}let rt;nt.CHECK_BOX_GROUP_CONTROLLER=class extends ht{constructor(t){super(t),this.checkGroups=new Map}in(t,e){if(!e)throw new Error("Default check groups don't exist!");(this.checkGroups.get(e)||this.initGroup(e)).checks.push(t),t.checkGroup=e}out(t){const e=this.checkGroups.get(t.checkGroup),i=e.checks.indexOf(t);i>0&&e.checks.splice(i,1),t.checkGroup=null}notifyCheck(t){const e=this.checkGroups.get(t.checkGroup);if(!e)return;const{checks:i}=e;for(let e=0,s=i.length;e<s;e++)i[e]!==t&&(i[e].checked=!1);e.selected=t}getSelected(t){var e;return null===(e=this.checkGroups.get(t))||void 0===e?void 0:e.selected}initGroup(t){const e={checks:[],selected:null};return this.checkGroups.set(t,e),e}},nt.FOCUS_CONTROLLER=class extends ht{constructor(t){super(t),this.tabGroups=new Map,this.useTab=!0,this.useForward=!0,this.useBack=!0}in(t,e=0,i="default"){let s=this.tabGroups.get(i);s||(s=[],this.tabGroups.set(i,s)),-1===s.indexOf(t)&&(t.tabIndex=void 0!==e?e:-1,t.tabGroup=i,s.push(t),s.sort((t,e)=>t.tabIndex-e.tabIndex))}out(t){const e=this.tabGroups.get(t.tabGroup);if(!e)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}notifyFocus(t){const e=this.currentItem;e&&(e.blur(),this.emit("blur",e)),this.currentItem=t,this.emit("focus",t),this.emit("focusChanged",t,e)}notifyBlur(){this.emit("blur",this.currentItem),this.emit("focusChanged",null,this.currentItem),this.currentItem=null}focus(t){const e=this.currentItem;e&&(e.blur(),this.emit("blur",e)),t.focus(),this.emit("focus",t),this.emit("focusChanged",t,e)}blur(){this.currentItem&&(this.currentItem.blur(),this.emit("blur",this.currentItem),this.emit("focusChanged",null,this.currentItem),this.currentItem=null)}onTab(){const{tabGroups:t,currentItem:e}=this;if(e){const i=t.get(e.tabGroup);let s=i.indexOf(e)+1;s>=i.length&&(s=0),this.focus(i[s])}}onForward(){if(!this.useForward)return;const{currentItem:t,tabGroups:e}=this;if(t){const i=e.get(t.tabGroup);let s=i.indexOf(t)+1;s>=i.length&&(s=i.length-1),this.focus(i[s])}}onBack(){const{currentItem:t,tabGroups:e}=this;if(t){const i=e.get(t.tabGroup);let s=i.indexOf(t)-1;s<0&&(s=0),this.focus(i[s])}}};class ot extends e.utils.EventEmitter{constructor(t){super(),this._disabled=!0,this._now=0,this.DeltaTime=0,this.Time=performance.now(),this.Ms=0,t&&(this.disabled=!1),ot.shared=this}get disabled(){return this._disabled}set disabled(t){this._disabled?(this._disabled=!1,ot.shared=this,this.update(performance.now(),!0)):this._disabled=!0}update(t){ot.shared._now=t,ot.shared.Ms=ot.shared._now-ot.shared.Time,ot.shared.Time=ot.shared._now,ot.shared.DeltaTime=.001*ot.shared.Ms,ot.shared.emit("update",ot.shared.DeltaTime),X._update(ot.shared.DeltaTime),ot.shared._disabled||requestAnimationFrame(ot.shared.update)}static on(t,e,i){ot.shared.on(t,e,i)}static once(t,e,i){ot.shared.once(t,e,i)}static removeListener(t,e){ot.shared.removeListener(t,e)}}ot.shared=new ot(!0);class at extends e.utils.EventEmitter{constructor(t,e,i,s,h,n,r,o,a,d=1,l=!0){super(),this.manager=t,this.key=e,this.startValue=i,this.endValue=s,this.erp=h,this.ease=n,this.observedValue=r,this.startTime=o,this.endTime=a,this._repeat=d,this._flip=l,this._next=null,this._target=null,this._observedProperty=null,this.autoCreated=!1}update(t=performance.now()){if(t=(t-this.startTime)/(this.endTime-this.startTime),t=Math.min(Math.max(t,0),1),this.ease&&(t=this.ease(t)),this.observedValue=this.erp(this.startValue,this.endValue,Math.min(Math.max(t,0),1),this.observedValue),this.emit("update",this.observedValue,this.key),this._target&&(this._target[this._observedProperty]=this.observedValue),t>=1){if(--this._repeat,this.emit("cycle",this),this._repeat>0){if(this._flip){const{startValue:t,endValue:e}=this;this.endValue=t,this.startValue=e}const t=this.endTime-this.startTime;return this.startTime+=t,void(this.endTime+=t)}this._next&&this.manager.queue(this._next),this.reset(),this.emit("complete",this),this.removeAllListeners()}}target(t,e){return this._target=t,this._observedProperty=e,this}repeat(t,e=!0){return this._repeat=t,this._flip=e,this}chain(t,e,i,s,h){const n=at.pool.pop()||new at;return n.manager=this.manager,n.key=0,n.startValue=t,n.endValue=e,n.startTime=this.endTime,n.endTime=n.startTime+i,n.erp=s,n.ease=h,this._next=n,n}reset(){this.ease=null,this._repeat=0,this._next=null,this._target=null,this._observedProperty=null}destroy(){this.reset(),this.autoCreated&&at.pool.push(this)}}at.pool=[];let dt=0;var lt=Object.freeze({__proto__:null,EaseBoth:t=>t<=.5?2*t*t:(t-.5)*(1.5-t)*2+.5,EaseIn:t=>t*t,EaseOut:t=>(1-t)*(1-t),NumberErp:(t,e,i)=>(1-i)*t+i*e,PointErp:(t,i,s,h)=>(h||(h=new e.Point),h.x=(1-s)*t.x+s*i.x,h.y=(1-s)*t.y+s*i.y,h),Tween:at,TweenManager:class{constructor(t=!0){this.onUpdate=()=>{for(const[,t]of this.tweenMap)t.update()},this.onTweenComplete=t=>{this.tweenMap.delete(t.key),t.destroy()},this.tweenMap=new Map,t&&this.start()}tween(t,e,i,s,h){const n=at.pool.pop()||new at;return n.autoCreated=!0,n.reset(),n.manager=this,n.key=dt++,n.startValue=t,n.endValue=e,n.erp=s,n.ease=h,n.startTime=performance.now(),n.endTime=n.startTime+i,this.tweenMap.set(n.key,n),n.on("complete",this.onTweenComplete),n}queue(t){return t.key=dt++,this.tweenMap.set(t.key,t),t.on("complete",this.onTweenComplete),this}start(){this.isRunning||(e.Ticker.shared.add(this.onUpdate),this.isRunning=!0)}stop(){this.isRunning&&(e.Ticker.shared.remove(this.onUpdate),this.isRunning=!1)}},get nextTweenKey(){return dt}});return t.AnchorLayout=class{onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){const e=this.host,{widgetChildren:i}=e,s=e.contentWidth,h=e.contentHeight;for(let e=0;e<i.length;e++){const n=i[e],r=n.layoutOptions||{},o=n.getMeasuredWidth(),a=n.getMeasuredHeight(),d=this.calculateAnchor(r.anchorLeft||0,s,!1),l=this.calculateAnchor(r.anchorTop||0,h,!1),u=this.calculateAnchor(r.anchorRight||0,s,!0),c=this.calculateAnchor(r.anchorBottom||0,h,!0);let g=d,p=l;switch(r.horizontalAlign){case t.ALIGN.MIDDLE:g=(u+d-o)/2;break;case t.ALIGN.RIGHT:g=u-o}switch(r.verticalAlign){case t.ALIGN.MIDDLE:p=(c+l-a)/2;break;case t.ALIGN.BOTTOM:p=c-a}n.layout(g,p,g+o,p+a)}}onMeasure(e,i,s,h){const n=this.host.widgetChildren;let r=0,o=0;const a=s===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:s,d=h===t.MeasureMode.EXACTLY?t.MeasureMode.AT_MOST:h;let l=!1;for(let s=0,h=n.length;s<h;s++){const h=n[s],u=h.layoutOptions||p.DEFAULT;if(u.width===p.FILL_PARENT)throw new Error("AnchorLayout does not support width = FILL_PARENT. Use anchorLeft = 0 & anchorRight = 0");if(u.height===p.FILL_PARENT)throw new Error("AnchorLayout does not support height = FILL_PARENT. Use anchorTop = 0 & anchorBottom = 0");const c=this.calculateAnchor(u.anchorLeft||0,e,!1),g=this.calculateAnchor(u.anchorTop||0,i,!1),m=this.calculateAnchor(u.anchorRight||0,e,!0),f=this.calculateAnchor(u.anchorBottom||0,i,!0),w=u.isWidthPredefined,M=u.isHeightPredefined,v=w?u.width:m-c,_=M?u.height:f-g,C=w?t.MeasureMode.EXACTLY:a,x=M?t.MeasureMode.EXACTLY:d;l=l||0===u.width||0===u.height,h.measure(v,_,C,x);const T=this.calculateReach(u.anchorLeft||0,u.anchorRight||0,h.getMeasuredWidth()),b=this.calculateReach(u.anchorTop||0,u.anchorBottom||0,h.getMeasuredHeight());r=Math.max(r,T),o=Math.max(o,b)}if(this.measuredWidth=g.resolveMeasuredDimen(r,e,s),this.measuredHeight=g.resolveMeasuredDimen(o,i,h),l)for(let e=0,i=n.length;e<i;e++){const i=n[e],s=i.layoutOptions||p.DEFAULT;if(0===s.width||0===s.height){const e=this.calculateAnchor(s.anchorLeft||0,this.measuredWidth,!1),h=this.calculateAnchor(s.anchorTop||0,this.measuredHeight,!1),n=this.calculateAnchor(s.anchorRight||0,this.measuredWidth,!0),r=this.calculateAnchor(s.anchorBottom||0,this.measuredHeight,!0);i.measure(s.isWidthPredefined?s.width:n-e,s.isHeightPredefined?s.height:r-h,0===s.width||s.isWidthPredefined?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST,0===s.height||s.isHeightPredefined?t.MeasureMode.EXACTLY:t.MeasureMode.AT_MOST)}}}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}calculateAnchor(t,e,i){const s=Math.abs(t)<1?t*e:t;return i?e-s:s}calculateReach(t,e,i){return Math.abs(t)<1&&Math.abs(e)<1?i/(1-e-t):Math.abs(t)<1?(e+i)/(1-t):Math.abs(e)<1?(t+i)/(1-e):t+i+e}},t.AnchorLayoutOptions=class extends p{constructor(e){super(e.width,e.height),this.anchorLeft=e.anchorLeft||0,this.anchorTop=e.anchorTop||0,this.anchorBottom=e.anchorBottom||0,this.anchorRight=e.anchorRight||0,this.horizontalAlign=e.horizontalAlign||t.ALIGN.LEFT,this.verticalAlign=e.verticalAlign||t.ALIGN.CENTER}},t.BorderLayout=tt,t.BorderLayoutOptions=f,t.Button=class extends _{constructor(t){super(t),this.isHover=!1,"string"==typeof t.text&&(t.text=new C(t.text,new e.TextStyle)),this.textWidget=t.text.setLayoutOptions(new m({width:p.WRAP_CONTENT,height:p.WRAP_CONTENT,x:.5,y:.5,anchor:m.CENTER_ANCHOR})),this.textWidget&&this.addChild(this.textWidget),this.contentContainer.buttonMode=!0,this.setupClick()}setupClick(){const t=this.eventBroker.click;t.onHover=(t,e)=>{this.isHover=e,this.emit("hover",e)},t.onPress=(t,e)=>{e&&(this.focus(),t.data.originalEvent.preventDefault()),this.emit("press",e)},t.onClick=t=>{this.click()},this.click=()=>{this.emit("click")}}update(){super.update()}initialize(){super.initialize(),this.setupClick(),this.insetContainer.interactiveChildren=!1}get value(){return this.textWidget?this.textWidget.text:""}set value(t){this.textWidget&&(this.textWidget.text=t)}get text(){return this.textWidget}set text(t){this.value=t}},t.CheckBox=class extends _{constructor(t){super(t),this.change=t=>{this.checkmark&&(this.checkmark.alpha=t?1:0)},this.click=()=>{this.emit("click"),null!==this.checkGroup&&this.checked||(this.checked=!this.checked,this.emit("changed",this.checked))},this._checked=void 0!==t.checked&&t.checked,this._value=t.value||"",this.checkGroup=t.checkGroup||null,this.checkmark=new v,this.checkmark.contentContainer.addChild(t.checkmark),this.checkmark.setLayoutOptions(new m({width:p.WRAP_CONTENT,height:p.WRAP_CONTENT,x:.5,y:.5,anchor:m.CENTER_ANCHOR})),this.checkmark.alpha=this._checked?1:0,this.addChild(this.checkmark),this.contentContainer.buttonMode=!0}update(){}get checked(){return this._checked}set checked(t){t!==this._checked&&(null!==this.checkGroup&&t&&this.stage.checkBoxGroupController.notifyCheck(this),this._checked=t,this.change(t))}get value(){return this._value}set value(t){this._value=t,this.checked&&this.stage.checkBoxGroupController.notifyCheck(this)}get selectedValue(){var t;return null===(t=this.stage)||void 0===t?void 0:t.checkBoxGroupController.getSelected(this.checkGroup).value}initialize(){super.initialize();const t=this.eventBroker.click;t.onHover=(t,e)=>{this.emit("hover",e)},t.onPress=(t,e)=>{e&&(this.focus(),t.data.originalEvent.preventDefault()),this.emit("press",e)},t.onClick=()=>{this.click()},null!==this.checkGroup&&this.stage.checkBoxGroupController.in(this,this.checkGroup)}},t.ClickManager=d,t.Ease=b,t.EventBroker=u,t.EventManager=a,t.FastLayout=w,t.FastLayoutOptions=m,t.Helpers=A,t.Insets=n,t.InteractiveGroup=v,t.LayoutOptions=p,t.ScrollBar=z,t.ScrollManager=c,t.ScrollWidget=et,t.SliceSprite=class extends g{constructor(t,e,i,s,h){super(t.width,t.height),this.bw=e||5,this.vs=void 0===s||s,this.hs=void 0===i||i,this.t=t.baseTexture,this.f=t.frame,this.tile=h,this.hs&&(this.setting.minWidth=2*e),this.vs&&(this.setting.minHeight=2*e),this.update=function(){this.initialized&&(vs&&hs?(str.x=sbr.x=sr.x=this._width-bw,sbl.y=sbr.y=sb.y=this._height-bw,sf.width=st.width=sb.width=this._width-2*bw,sf.height=sl.height=sr.height=this._height-2*bw):hs?(sr.x=this._width-bw,sl.height=sr.height=sf.height=this._height,sf.width=this._width-2*bw):(sb.y=this._height-bw,st.width=sb.width=sf.width=this._width,sf.height=this._height-2*bw),null!==this.tint&&(sf.tint=this.tint,vs&&hs&&(stl.tint=str.tint=sbl.tint=sbr.tint=this.tint),hs&&(sl.tint=sr.tint=this.tint),vs&&(st.tint=sb.tint=this.tint)),null!==this.blendMode&&(sf.blendMode=this.blendMode,vs&&hs&&(stl.blendMode=str.blendMode=sbl.blendMode=sbr.blendMode=this.blendMode),hs&&(sl.blendMode=sr.blendMode=this.blendMode),vs&&(st.blendMode=sb.blendMode=this.blendMode)))}}initialize(){super.initialize();const{f:t,bw:i}=this;this.vs&&this.hs?(this.ftl=new e.Rectangle(t.x,t.y,i,i),this.ftr=new e.Rectangle(t.x+t.width-i,t.y,i,i),this.fbl=new e.Rectangle(t.x,t.y+t.height-i,i,i),this.fbr=new e.Rectangle(t.x+t.width-i,t.y+t.height-i,i,i),this.ft=new e.Rectangle(t.x+i,t.y,t.width-2*i,i),this.fb=new e.Rectangle(t.x+i,t.y+t.height-i,t.width-2*i,i),this.fl=new e.Rectangle(t.x,t.y+i,i,t.height-2*i),this.fr=new e.Rectangle(t.x+t.width-i,t.y+i,i,t.height-2*i),this.ff=new e.Rectangle(t.x+i,t.y+i,t.width-2*i,t.height-2*i)):this.hs?(this.fl=new e.Rectangle(this.f.x,t.y,i,t.height),this.fr=new e.Rectangle(t.x+t.width-i,t.y,i,t.height),this.ff=new e.Rectangle(t.x+i,t.y,t.width-2*i,t.height)):(this.ft=new e.Rectangle(t.x,t.y,t.width,i),this.fb=new e.Rectangle(t.x,t.y+t.height-i,t.width,i),this.ff=new e.Rectangle(t.x,t.y+i,t.width,t.height-2*i));const{t:s,ff:h,fl:n,fr:r,ft:o,fb:a}=this;this.sf=this.tile?new e.extras.TilingSprite(new e.Texture(s,h)):new e.Sprite(new e.Texture(s,h)),this.contentContainer.addChildAt(this.sf,0),this.vs&&this.hs&&(this.stl=new e.Sprite(new e.Texture(s,this.ftl)),this.str=new e.Sprite(new e.Texture(s,this.ftr)),this.sbl=new e.Sprite(new e.Texture(s,this.fbl)),this.sbr=new e.Sprite(new e.Texture(s,this.fbr)),this.contentContainer.addChildAt(this.stl,0),this.contentContainer.addChildAt(this.str,0),this.contentContainer.addChildAt(this.sbl,0),this.contentContainer.addChildAt(this.sbr,0)),hs&&(this.sl=this.tile?new e.extras.TilingSprite(new e.Texture(s,n)):new e.Sprite(new e.Texture(s,n)),this.sr=this.tile?new e.extras.TilingSprite(new e.Texture(s,r)):new e.Sprite(new e.Texture(s,r)),this.contentContainer.addChildAt(this.sl,0),this.contentContainer.addChildAt(this.sr,0)),this.vs&&(this.st=this.tile?new e.extras.TilingSprite(new e.Texture(s,o)):new e.Sprite(new e.Texture(s,o)),this.sb=this.tile?new e.extras.TilingSprite(new e.Texture(s,a)):new e.Sprite(new e.Texture(s,a)),this.contentContainer.addChildAt(this.st,0),this.contentContainer.addChildAt(this.sb,0)),this.vs&&this.hs&&(this.st.x=i,this.sb.x=i,this.sl.y=i,this.sr.y=i,this.stl.width=i,this.str.width=i,this.sbl.width=i,this.sbr.width=i,this.stl.height=i,this.str.height=i,this.sbl.height=i,this.sbr.height=i),this.hs&&(this.sf.x=this.sl.width=this.sr.width=i),this.vs&&(this.sf.y=this.st.height=this.sb.height=i)}update(){}},t.Slider=k,t.SortableList=class extends v{constructor(t,e,i){super(0,0),this.desc=void 0!==t&&t,this.tweenTime=e||0,this.tweenEase=i,this.items=[]}addChild(t,e,i){super.addChild(t),-1===this.items.indexOf(t)&&this.items.push(t),"function"==typeof e&&(t._sortListValue=e),"function"==typeof i&&(t._sortListThenByValue=i),t._sortListRnd||(t._sortListRnd=Math.random()),this.sort()}removeChild(t){if(arguments.length>1)for(let t=0;t<arguments.length;t++)this.removeChild(arguments[t]);else{super.removeChild(t);const e=this.items.indexOf(t);-1!==e&&this.items.splice(e,1),this.sort()}}sort(t=!1){clearTimeout(this._sortTimeout),t?this._sort():this._sortTimeout=setTimeout(()=>{this._sort()},0)}_sort(){const t=this.desc;let e=0,i=!0;this.items.sort((function(e,i){let s=e._sortListValue()<i._sortListValue()?t?1:-1:e._sortListValue()>i._sortListValue()?t?-1:1:0;return 0===s&&e._sortListThenByValue&&i._sortListThenByValue&&(s=e._sortListThenByValue()<i._sortListThenByValue()?t?1:-1:e._sortListThenByValue()>i._sortListThenByValue()?t?-1:1:0),0===s&&(s=e._sortListRnd>i._sortListRnd?1:e._sortListRnd<i._sortListRnd?-1:0),s}));for(let t=0;t<this.items.length;t++){const s=this.items[t];i=!i,this.tweenTime>0?X.fromTo(s,this.tweenTime,{x:s.x,y:s.y},{x:0,y:e},this.tweenEase):(s.x=0,s.y=e),e+=s.height,"function"==typeof s.altering&&s.altering(i)}this.tweenTime>0&&setTimeout(()=>{this.updatesettings(!1,!0)},1e3*this.tweenTime)}},t.Sprite=it,t.Stage=nt,t.TextInput=class extends _{constructor(t){super(t),this.onKeyDown=t=>{if(t.which!==this.ctrlKey&&t.which!==this.cmdKey||(this.ctrlDown=!0),t.which===this.shiftKey&&(this.shiftDown=!0),!t.defaultPrevented){if(13===t.which)return this.insertTextAtCaret("\n"),void t.preventDefault();if(this.ctrlDown){if(65===t.which)return this.select(),void t.preventDefault();if(90===t.which)return this.value!=this._lastValue&&(this.valueEvent=this._lastValue),this.setCaretIndex(this._lastValue.length+1),void t.preventDefault()}if(8===t.which)return this.deleteSelection()||(this.caret._index>0||1===this.chars.length&&this.caret._atEnd)&&(this.caret._atEnd?(this.valueEvent=this.value.slice(0,this.chars.length-1),this.setCaretIndex(this.caret._index)):(this.valueEvent=this.value.slice(0,this.caret._index-1)+this.value.slice(this.caret._index),this.setCaretIndex(this.caret._index-1))),void t.preventDefault();if(46===t.which)return this.deleteSelection()||this.caret._atEnd||(this.valueEvent=this.value.slice(0,this.caret._index)+this.value.slice(this.caret._index+1),this.setCaretIndex(this.caret._index)),void t.preventDefault();if(37!==t.which&&39!==t.which)return!this.multiLine||38!==t.which&&40!==t.which?void 0:(this.vrdd=38===t.which,this.shiftDown?this.hasSelection?(this.de.y=Math.max(0,Math.min(this.textHeightPX,this.de.y+(this.vrdd?-this.lineHeight:this.lineHeight))),this.updateClosestIndex(this.de,!1),Math.abs(this.si-this.ei)<=1?this.setCaretIndex(this.sie?this.si+1:this.si):(this.caret._index=(this.eie?this.ei+1:this.ei)+(this.caret._down?-1:0),this.selectRange(this.caret._down?this.si:this.si-1,this.caret._index))):(this.si=this.caret._index,this.sie=!1,this.de.copyFrom(this.caret),this.de.y=Math.max(0,Math.min(this.textHeightPX,this.de.y+(this.vrdd?-this.lineHeight:this.lineHeight))),this.updateClosestIndex(this.de,!1),this.caret._index=(this.eie?this.ei+1:ei)-(this.vrdd?0:1),this.selectRange(this.vrdd?this.si-1:this.si,this.caret._index),this.caret._down=!this.vrdd):this.hasSelection?this.setCaretIndex(this.vrdd?this.selectionStart:this.selectionEnd+1):(this.ds.copyFrom(this.caret),this.ds.y+=this.vrdd?-this.lineHeight:this.lineHeight,this.ds.x+=1,this.updateClosestIndex(this.ds,!0),this.setCaretIndex(this.sie?this.si+1:this.si)),void t.preventDefault());if(this.rdd=37===t.which,this.shiftDown)if(this.hasSelection){if(this.selectionStart===this.caret._index)if(this.selectionStart===this.selectionEnd&&this.rdd===this.caret._forward)this.setCaretIndex(this.caret._forward?this.caret._index:this.caret._index+1);else{const t=this.rdd?this.caret._index-1:this.caret._index+1;this.selectRange(t,this.selectionEnd),this.caret._index=Math.min(this.chars.length-1,Math.max(0,t))}else{const t=this.rdd?this.caret._index-1:this.caret._index+1;this.selectRange(this.selectionStart,t),this.caret._index=Math.min(this.chars.length-1,Math.max(0,t))}}else{const t=this.caret._atEnd?this.caret._index+1:this.caret._index,e=this.rdd?t-1:t;this.selectRange(e,e),this.caret._index=e,this.caret._forward=!rdd}else this.hasSelection?this.setCaretIndex(this.rdd?this.selectionStart:this.selectionEnd+1):this.setCaretIndex(this.caret._index+(this.rdd?this.caret._atEnd?0:-1:1));t.preventDefault()}},this.keyUpEvent=t=>{t.which!==this.ctrlKey&&t.which!==this.cmdKey||(this.ctrlDown=!1),t.which===this.shiftKey&&(this.shiftDown=!1),this.emit("keyup",t),t.defaultPrevented},this.copyEvent=t=>{if(this.emit("copy",t),!t.defaultPrevented){if(this.hasSelection){(t.clipboardData||window.clipboardData).setData("Text",this.value.slice(this.selectionStart,this.selectionEnd+1))}t.preventDefault()}},this.cutEvent=t=>{this.emit("cut",t),t.defaultPrevented||(this.hasSelection&&(this.copyEvent(t),this.deleteSelection()),t.preventDefault())},this.pasteEvent=t=>{if(this.emit("paste",t),t.defaultPrevented)return;const e=t.clipboardData||window.clipboardData;this.insertTextAtCaret(e.getData("Text")),t.preventDefault()},this.inputEvent=t=>{const e=rt.value;e.length&&(this.insertTextAtCaret(e),rt.value=""),t.preventDefault()},this.inputBlurEvent=t=>{this.blur()},this.focus=()=>{if(!this._isFocused){super.focus();const t=`${this.contentContainer.worldTransform.tx}px`,e=`${this.contentContainer.worldTransform.ty}px`,i=`${this.contentContainer.height}px`,s=`${this.contentContainer.width}px`;rt.setAttribute("style",`position:fixed; left:${t}; top:${e}; height:${i}; width:${s};`),rt.value="",rt.focus(),rt.setAttribute("style","position:fixed; left:-10px; top:-10px; width:0px; height: 0px;"),this.innerContainer.cacheAsBitmap=!1,rt.addEventListener("blur",this.inputBlurEvent,!1),document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.keyUpEvent,!1),document.addEventListener("paste",this.pasteEvent,!1),document.addEventListener("copy",this.copyEvent,!1),document.addEventListener("cut",this.cutEvent,!1),rt.addEventListener("input",this.inputEvent,!1),setTimeout(()=>{this.caret.visible||this.selection.visible||this.multiLine||this.setCaretIndex(this.chars.length)},0)}},this.blur=()=>{this._isFocused&&(super.blur(),this.ctrlDown=!1,this.shiftDown=!1,this.hideCaret(),this.clearSelection(),this.chars.length>1&&(this.innerContainer.cacheAsBitmap=!0),rt.removeEventListener("blur",this.inputBlurEvent),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.keyUpEvent),document.removeEventListener("paste",this.pasteEvent),document.removeEventListener("copy",this.copyEvent),document.removeEventListener("cut",this.cutEvent),rt.removeEventListener("input",this.inputEvent),rt.blur()),this.multiLine||this.resetScrollPosition()},this.setCaretIndex=t=>{if(this.caret._atEnd=t>=this.chars.length,this.caret._index=Math.max(0,Math.min(this.chars.length-1,t)),this.chars.length&&t>0){let e=Math.max(0,Math.min(t,this.chars.length-1)),i=this.chars[e];i&&i.wrapped?(this.caret.x=i.x,this.caret.y=i.y):(e=Math.max(0,Math.min(t-1,this.chars.length-1)),i=this.chars[e],this.caret.x=this.chars[e].x+this.chars[e].width,this.caret.y=this.chars[e].lineIndex*this.lineHeight+.5*(this.lineHeight-this.textHeight))}else this.caret.x=0,this.caret.y=.5*(this.lineHeight-this.textHeight);this.scrollToPosition(this.caret),this.showCaret()},this.select=()=>{this.selectRange(0,this.chars.length-1)},this.selectWord=t=>{let e=this.chars.length,i=0;for(let s=0;s<this.chars.length;s++)this.chars[s].wordIndex===t&&(s<e&&(e=s),s>i&&(i=s));this.selectRange(e,i)},this.selectRange=(t,e)=>{if(t>-1&&e>-1){const i=Math.min(t,e,this.chars.length-1),s=Math.min(Math.max(t,e),this.chars.length-1);i===this.selectionStart&&s===this.selectionEnd||(this.hasSelection=!0,this.selection.visible=!0,this.selectionStart=i,this.selectionEnd=s,this.hideCaret(),this.updateSelectionGraphics(),this.updateSelectionColors()),this.focus()}else this.clearSelection()},this.clearSelection=()=>{this.hasSelection&&(this.hasSelection=!1,this.selection.visible=!1,this.selectionStart=-1,this.selectionEnd=-1,this.updateSelectionColors())},this.updateSelectionGraphics=()=>{const t=this.chars[this.selectionStart];if(void 0!==t){let e=t.x,i=t.y,s=0;const h=this.textHeight;let n=t.lineIndex;this.selection.clear();for(let t=this.selectionStart;t<=this.selectionEnd;t++){const r=this.chars[t];r.lineIndex!=n&&(this.drawSelectionRect(e,i,s,h),e=r.x,i=r.y,n=r.lineIndex,s=0),s+=r.width}this.drawSelectionRect(e,i,s,h),this.innerContainer.addChildAt(this.selection,0)}},this.drawSelectionRect=(t,e,i,s)=>{this.selection.beginFill(`0x${this.selectedBackgroundColor.slice(1)}`,1),this.selection.moveTo(t,e),this.selection.lineTo(t+i,e),this.selection.lineTo(t+i,e+s),this.selection.lineTo(t,e+s),this.selection.endFill()},void 0===rt&&(rt=document.createElement("INPUT"),rt.setAttribute("type","text"),rt.setAttribute("id","_pui_tempInput"),rt.setAttribute("style","position:fixed; left:-10px; top:-10px; width:0px; height: 0px;"),document.body.appendChild(rt)),this.options=t,this._dirtyText=!0,this.maxLength=t.maxLength||0,this._value=this._lastValue=t.value||"",this.maxLength&&(this._value=this._value.slice(0,this.maxLength)),this.chars=[],this.multiLine=void 0!==t.multiLine&&t.multiLine,this.color=t.style&&t.style.fill?t.style.fill:"#000000",this.selectedColor=t.selectedColor||"#ffffff",this.selectedBackgroundColor=t.selectedBackgroundColor||"#318cfa",this.tempText=new e.Text("1",t.style),this.textHeight=this.tempText.height,this.lineHeight=t.lineHeight||this.textHeight||this._height,this.tempText.destroy(),this.selection=new e.Graphics,this.selection.visible=!1,this.selection._startIndex=0,this.selection._endIndex=0,this.caret=new e.Graphics,this.caret.visible=!1,this.caret._index=0,this.caret.lineStyle(t.caretWidth||1,"#ffffff",1),this.caret.moveTo(0,0),this.caret.lineTo(0,this.textHeight);const i=void 0!==t.paddingLeft?t.paddingLeft:t.padding,s=void 0!==t.paddingRight?t.paddingRight:t.padding,h=void 0!==t.paddingBottom?t.paddingBottom:t.padding,n=void 0!==t.paddingTop?t.paddingTop:t.padding;this.textContainer=new et({scrollX:!this.multiLine,scrollY:this.multiLine,dragScrolling:this.multiLine,expandMask:2,softness:.2,overflowX:40,overflowY:40}).setPadding(i||3,n||3,s||3,h||3).setLayoutOptions(new p(p.FILL_PARENT,p.FILL_PARENT)),this.addChild(this.textContainer),this.multiLine&&(this._useNext=this._usePrev=!1,this.textContainer.dragRestrictAxis="y",this.textContainer.dragThreshold=5,this.dragRestrictAxis="x",this.dragThreshold=5),this.sp=new e.Point,this._sp=new e.Point,this.ds=new e.Point,this.de=new e.Point,this.rdd=!1,this.vrdd=!1,this.selectionStart=-1,this.selectionEnd=-1,this.hasSelection=!1,this.t=performance.now(),this.cc=0,this.textLengthPX=0,this.textHeightPX=0,this.lineIndexMax=0,this.ctrlDown=!1,this.shiftDown=!1,this.shiftKey=16,this.ctrlKey=17,this.cmdKey=91,this.setupDrag()}setupDrag(){const t=new l(this);t.onPress=(t,e)=>{if(e){const e=performance.now()-this.t;if(this.t=performance.now(),e<250)if(this.cc++,this.cc>1)this.select();else{this.innerContainer.toLocal(this.sp,void 0,this.ds,!0),this.updateClosestIndex(this.ds,!0);const t=this.chars[this.si];t&&(-1!=t.wordIndex?this.selectWord(t.wordIndex):this.selectRange(this.si,this.si))}else this.cc=0,this.sp.copyFrom(t.data.global),this.innerContainer.toLocal(this.sp,void 0,this.ds,!0),this.chars.length&&(this.updateClosestIndex(this.ds,!0),this.setCaretIndex(this.sie?this.si+1:this.si))}t.data.originalEvent.preventDefault()},t.onDragMove=(t,e)=>{this.chars.length&&this._isFocused&&(this.de.x=this.sp.x+e.x,this.de.y=this.sp.y+e.y,this.innerContainer.toLocal(this.de,void 0,this.de,!0),this.updateClosestIndex(this.de,!1),this.si<this.ei?(this.selectRange(this.sie?this.si+1:this.si,this.eie?this.ei:this.ei-1),this.caret._index=this.eie?this.ei:this.ei-1):this.si>this.ei?(this.selectRange(this.ei,this.sie?this.si:this.si-1),this.caret._index=this.ei):this.sie===this.eie?this.setCaretIndex(this.sie?this.si+1:this.si):(this.selectRange(this.si,this.ei),this.caret._index=this.ei),this.caret._forward=this.si<=this.ei,this.caret._down=e.y>0,this.scrollToPosition(this.de))}}get innerContainer(){return this.textContainer.innerContainer.insetContainer}update(){this.width!==this._lastWidth&&(this._lastWidth=this._width,this.multiLine&&(this.updateText(),this.caret.visible&&this.setCaretIndex(this.caret._index),this.hasSelection&&this.updateSelectionGraphics())),this._dirtyText&&(this.updateText(),this._dirtyText=!1)}updateText(){this.textLengthPX=0,this.textHeightPX=0,this.lineIndexMax=0;let t=0;const i=this._value.length;let s=0,h=.5*(this.lineHeight-this.textHeight),n=0;if(this.chars.length>i){for(n=this.chars.length-1;n>=i;n--)this.innerContainer.removeChild(this.chars[n]),this.chars[n].destroy();this.chars.splice(i,this.chars.length-i)}let r=!1,o=!1,a=0,d=-1,l=!1;for(n=0;n<this._value.length;n++){(r||o)&&(d=n,a++);let i=this._value[n];r=" "===i,o="\n"===i,o&&(i="");let u=this.chars[n];u?u.text=i:(u=new e.Text(i,this.options.style),this.innerContainer.addChild(u),this.chars.push(u)),u.scale.x=o?0:1,u.wrapped=l,l=!1,!(o||this.multiLine&&s+u.width>=this._width-this.paddingLeft-this.paddingRight)||(t++,s=0,h+=this.lineHeight,-1===d||o)?(u.lineIndex=t,u.x=s,u.y=h,u.wordIndex=r||o?-1:a,s+=u.width,s>this.textLengthPX&&(this.textLengthPX=s),h>this.textHeightPX&&(this.textHeightPX=h)):(n=d-1,d=-1,l=!0)}this.lineIndexMax=t,this.innerContainer.addChild(this.caret),this.innerContainer.cacheAsBitmap&&(this.innerContainer.cacheAsBitmap=!1,this.innerContainer.cacheAsBitmap=!0),this.textContainer.update()}updateClosestIndex(t,e){let i=99999,s=-1,h=!1,n=0;this.lineIndexMax>0&&(n=Math.max(0,Math.min(this.lineIndexMax,Math.floor(t.y/this.lineHeight))));for(let e=0;e<this.chars.length;e++){const r=this.chars[e];if(r.lineIndex!==n)continue;const o=Math.abs(t.x-(r.x+.5*r.width));o<i&&(i=o,s=e,h=t.x>r.x+.5*r.width)}e?(this.si=s,this.sie=h):(this.ei=s,this.eie=h)}deleteSelection(){return!!this.hasSelection&&(this.value=this.value.slice(0,this.selectionStart)+this.value.slice(this.selectionEnd+1),this.setCaretIndex(this.selectionStart),!0)}updateSelectionColors(){for(let t=0;t<this.chars.length;t++)t>=this.selectionStart&&t<=this.selectionEnd?this.chars[t].style.fill=this.selectedColor:this.chars[t].style.fill=this.color}scrollToPosition(t){this._sp.x=t.x,this._sp.y=t.y,this.multiLine&&this._sp.y>=this.lineHeight&&(this._sp.y+=this.lineHeight),this.textContainer.focusPosition(this._sp)}resetScrollPosition(){this._sp.set(0,0),this.textContainer.focusPosition(this._sp)}hideCaret(){this.caret.visible=!1,clearInterval(this.caretInterval)}showCaret(){this.clearSelection(),clearInterval(this.caretInterval),this.caret.alpha=1,this.caret.visible=!0,this.caretInterval=setInterval(()=>{this.caret.alpha=0===this.caret.alpha?1:0},500)}insertTextAtCaret(t){if(this.multiLine||-1===t.indexOf("\n")||(t=t.replace(/\n/g,"")),this.hasSelection&&this.deleteSelection(),!this.maxLength||this.chars.length<this.maxLength)if(this.caret._atEnd)this.valueEvent+=t,this.setCaretIndex(this.chars.length);else{const e=Math.min(this.chars.length-1,this.caret._index);this.valueEvent=this.value.slice(0,e)+t+this.value.slice(e),this.setCaretIndex(e+t.length)}}get valueEvent(){return this._value}set valueEvent(t){this.maxLength&&(t=t.slice(0,this.maxLength)),this._value!=t&&(this.value=t,this.emit("change"))}get value(){return this._value}set value(t){this.maxLength&&(t=t.slice(0,this.maxLength)),this._value!=t&&(this._lastValue=this._value,this._value=t,this._dirtyText=!0,this.update())}get text(){return this.value}set text(t){this.value=t}},t.TextWidget=C,t.Ticker=ot,t.TilingSprite=class extends g{constructor(t,i,s){const h=new e.extras.TilingSprite(t);super(i||h.width,s||h.height),this.sprite=h,this.contentContainer.addChild(this.sprite)}update(){null!==this.tint&&(this.sprite.tint=this.tint),null!==this.blendMode&&(this.sprite.blendMode=this.blendMode),this.sprite.width=this._width,this.sprite.height=this._height}get tilePosition(){return this.sprite.tilePosition}set tilingPosition(t){this.sprite.tilePosition=t}get tileScale(){return this.sprite.tileScale}set tileScale(t){this.sprite.tileScale=t}},t.Widget=g,t.WidgetGroup=M,t.create=L,t.tween=lt,t.wrapEase=I,t}({},PIXI,__filters);Object.assign(this.PUXI,puxi_js);
//# sourceMappingURL=puxi.min.js.map
